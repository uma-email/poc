<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1568" height="997"><desc>Title%20UMA-compliant%20communications%20platform%20-%20Bob%20from%20Alice%20(pull%20data)%0A%0Aactor%20%22Alice%20(RO)%5Cnalice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22UMA%20Server%5Cnfoo.com%22%20as%20asServer%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnfoo.com%22%20as%20rsServer%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnbar.com%22%20as%20rqpClient%20%23lightsteelblue%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnbar.com%22%20as%20claimsProvider%20%23lightsteelblue%0Aparticipant%20%22IAM%20Server%5Cnbar.com%22%20as%20authServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RqP)%5Cnbob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Fbar.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Bob's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20bar.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20foo.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20bar.com%20IAM%20Server%0Anote%20over%20rsServer%3Afoo.com%20admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%5Cn'Outgoing'%20at%20the%20foo.com%20UMA%20Server%20with%20the%20associated%20scopes%20'query'%2C%20'view'%0ArqpClient%3C-Bob%3AInitiate%20request%0ArsServer%3C-rqpClient%3A1.%20Request%20Alice's%20'Outgoing'%20resource%5Cn(scope%3Dquery%2C%20view)%0ArsServer-%3ErqpClient%3A2.%20401%20with%20permission%20ticket%0ArqpClient-%3EauthServer%3A3.%20b)%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0ArqpClient%3C-authServer%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Bob's%20email_address%2C%20ticket_challenge)%0AclaimsProvider-%3EauthServer%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Drealm-management%2C%20role%3Dquery-users%2C%20view-users)%0AclaimsProvider%3C-authServer%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Bob's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Bob's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Bob's%20user_claims%0A%0ArqpClient%3C-claimsProvider%3A12.%20Return%20claims_token%5Cn(Bob's%20user_claims)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArsServer%3C-rqpClient%3A15.%20Get%20data%20from%20Alice's%20'Outgoing'%20resource%5Cn(RPT)%0ArsServer-%3ErqpClient%3A16.%20200%20OK</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1568" height="997"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="10.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.6793606872436" y="13.19381805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA-compliant communications platform - Bob from Alice (pull data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 35.31561055361328 78.15138224949999 L 35.31561055361328 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 239.59776767033205 78.15138224949999 L 239.59776767033205 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 443.8799247870508 78.15138224949999 L 443.8799247870508 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 78.15138224949999 L 696.0432661920509 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1071.0257981941343 78.15138224949999 L 1071.0257981941343 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1463.8948048055927 78.15138224949999 L 1463.8948048055927 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1534.6661882134522 78.15138224949999 L 1534.6661882134522 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 32.143922998476604 M 35.31561055361328 37.16258750749999 L 35.31561055361328 47.893559521499995 M 28.98257788961328 41.03277413549999 L 41.648643217613284 41.03277413549999 M 35.31561055361328 47.893559521499995 L 28.98257788961328 57.92086123949999 M 35.31561055361328 47.893559521499995 L 41.648643217613284 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="13.808065082421876" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 204.65694619001172 45.694589846499994 L 274.53858915065234 45.694589846499994 L 274.53858915065234 78.15138224949999 L 204.65694619001172 78.15138224949999 L 204.65694619001172 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="214.20047457951173" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="223.00707705753908" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 388.4609310044844 45.694589846499994 L 499.29891856961723 45.694589846499994 L 499.29891856961723 78.15138224949999 L 388.4609310044844 78.15138224949999 L 388.4609310044844 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.0044593939844" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="427.28923417425784" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 664.2064867649532 45.694589846499994 L 727.8800456191485 45.694589846499994 L 727.8800456191485 78.15138224949999 L 664.2064867649532 78.15138224949999 L 664.2064867649532 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="673.7500151544532" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="679.4526366144141" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1017.6860433031694 45.694589846499994 L 1124.365553085099 45.694589846499994 L 1124.365553085099 78.15138224949999 L 1017.6860433031694 78.15138224949999 L 1017.6860433031694 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1027.2295716926694" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1054.4351686164975" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1431.0263939087686 45.694589846499994 L 1496.763215702417 45.694589846499994 L 1496.763215702417 78.15138224949999 L 1431.0263939087686 78.15138224949999 L 1431.0263939087686 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1440.5699222982685" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1447.304175227956" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1539.6798390724523 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 1539.679836565627 32.143922998476604 M 1534.6661882134522 37.16258750749999 L 1534.6661882134522 47.893559521499995 M 1528.3331555494522 41.03277413549999 L 1540.9992208774522 41.03277413549999 M 1534.6661882134522 47.893559521499995 L 1528.3331555494522 57.92086123949999 M 1534.6661882134522 47.893559521499995 L 1540.9992208774522 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1512.8921937676514" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1505.559094402417" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 966.1393164079997 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 966.1343027579762 M 35.31561055361328 971.1529672669997 L 35.31561055361328 981.8839392809997 M 28.98257788961328 975.0231538949997 L 41.648643217613284 975.0231538949997 M 35.31561055361328 981.8839392809997 L 28.98257788961328 991.9112409989997 M 35.31561055361328 981.8839392809997 L 41.648643217613284 991.9112409989997" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="13.808065082421876" y="948.9433735494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="957.7392522494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 204.65694619001172 940.1474948494997 L 274.53858915065234 940.1474948494997 L 274.53858915065234 972.6042872524997 L 204.65694619001172 972.6042872524997 L 204.65694619001172 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="214.20047457951173" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="223.00707705753908" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 388.4609310044844 940.1474948494997 L 499.29891856961723 940.1474948494997 L 499.29891856961723 972.6042872524997 L 388.4609310044844 972.6042872524997 L 388.4609310044844 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.0044593939844" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="427.28923417425784" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 664.2064867649532 940.1474948494997 L 727.8800456191485 940.1474948494997 L 727.8800456191485 972.6042872524997 L 664.2064867649532 972.6042872524997 L 664.2064867649532 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="673.7500151544532" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="679.4526366144141" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1017.6860433031694 940.1474948494997 L 1124.365553085099 940.1474948494997 L 1124.365553085099 972.6042872524997 L 1017.6860433031694 972.6042872524997 L 1017.6860433031694 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1027.2295716926694" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1054.4351686164975" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1431.0263939087686 940.1474948494997 L 1496.763215702417 940.1474948494997 L 1496.763215702417 972.6042872524997 L 1431.0263939087686 972.6042872524997 L 1431.0263939087686 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1440.5699222982685" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1447.304175227956" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1539.6798390724523 966.1393164079997 A 5.013650858999999 5.013650858999999 0 1 1 1539.679836565627 966.1343027579762 M 1534.6661882134522 971.1529672669997 L 1534.6661882134522 981.8839392809997 M 1528.3331555494522 975.0231538949997 L 1540.9992208774522 975.0231538949997 M 1534.6661882134522 981.8839392809997 L 1528.3331555494522 991.9112409989997 M 1534.6661882134522 981.8839392809997 L 1540.9992208774522 991.9112409989997" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1512.8921937676514" y="948.9433735494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1505.559094402417" y="957.7392522494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 764.3604632778062 95.7431396495 L 1369.7748422804625 95.7431396495 L 1377.6911331104625 103.65943047949999 L 1377.6911331104625 133.5654180595 L 764.3604632778062 133.5654180595 L 764.3604632778062 95.7431396495 M 1369.7748422804625 95.7431396495 L 1369.7748422804625 103.65943047949999 L 1377.6911331104625 103.65943047949999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.6746934578061" y="108.0573698295" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.6746934578061" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.7547563240171" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="947.938075415814" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.6746934578061" y="125.64912722950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Bob's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 448.27786413705087 146.7592361095 L 935.892377417051 146.7592361095 L 943.808668247051 154.6755269395 L 943.808668247051 184.5815145195 L 448.27786413705087 184.5815145195 L 448.27786413705087 146.7592361095 M 935.892377417051 146.7592361095 L 935.892377417051 154.6755269395 L 943.808668247051 154.6755269395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="460.59209431705085" y="159.0734662895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="460.59209431705085" y="167.8693449895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at bar.com IAM Server and pre-registered as a universal AEMS public client at foo.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="460.59209431705085" y="176.6652236895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at bar.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 267.8268030054883 197.7753325695 L 612.0167557386133 197.7753325695 L 619.9330465686132 205.6916233995 L 619.9330465686132 226.8017322795 L 267.8268030054883 226.8017322795 L 267.8268030054883 197.7753325695 M 612.0167557386133 197.7753325695 L 612.0167557386133 205.6916233995 L 619.9330465686132 205.6916233995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="280.1410331854883" y="210.08956274949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com admin has set up the Resource Server and registers it's resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="280.1410331854883" y="218.88544144949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Outgoing' at the foo.com UMA Server with the associated scopes 'query', 'view'</text></g><g><g><rect fill="white" stroke="none" x="1083.4410460813453" y="239.9955503295" width="63.8273622428125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1084.7604278863453" y="247.9118411595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1534.6661882134522 251.43019263949998 L 703.2852063217175 251.43019263949998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,251.43019263949998) translate(-696.0432661920509,-251.43019263949998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 703.3731651087176 247.76524318116665 L 696.0432661920509 251.43019263949998 L 703.3731651087176 255.0951420978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="490.0089205326954" y="264.6240106894999" width="159.90534991371095" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="490.0089205326954" y="273.41988938949993" width="85.67631548988281" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="491.3283023376954" y="272.5403015194999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="491.3283023376954" y="281.3361802194999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=query, view)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 284.85453169949994 L 451.12186491671747 284.85453169949994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(443.8799247870508,284.85453169949994) translate(-443.8799247870508,-284.85453169949994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 451.20982370371746 281.1895822411666 L 443.8799247870508 284.85453169949994 L 451.20982370371746 288.5194811578333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="510.0566729130665" y="298.04834974949995" width="119.80984515296875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="511.3760547180665" y="305.9646405794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 443.8799247870508 309.48299205949996 L 688.8013260623842 309.48299205949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,309.48299205949996) translate(-696.0432661920509,-309.48299205949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 688.7133672753841 305.8180426011666 L 696.0432661920509 309.48299205949996 L 688.7133672753841 313.1479415178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="965.3615372387436" y="322.67681010949997" width="98.56188983070312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="965.3615372387436" y="331.47268880949997" width="229.21499652015626" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="966.6809190437436" y="330.59310093949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. b) Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="966.6809190437436" y="339.38897963949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 342.9073311195 L 1456.652864675926 342.9073311195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1463.8948048055927,342.9073311195) translate(-1463.8948048055927,-342.9073311195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1456.564905888926 339.24238166116663 L 1463.8948048055927 342.9073311195 L 1456.564905888926 346.57228057783334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="967.2927353588608" y="356.1011491695" width="225.3526002799219" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="968.6121171638608" y="364.01743999949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1463.8948048055927 367.5357914795 L 703.2852063217175 367.5357914795" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,367.5357914795) translate(-696.0432661920509,-367.5357914795)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 703.3731651087176 363.87084202116665 L 696.0432661920509 367.5357914795 L 703.3731651087176 371.20074093783336 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 565.0458161023829 380.7296095295 L 819.1244254517189 380.7296095295 L 827.0407162817189 388.6459003595 L 827.0407162817189 409.75600923950003 L 565.0458161023829 409.75600923950003 L 565.0458161023829 380.7296095295 M 819.1244254517189 380.7296095295 L 819.1244254517189 388.6459003595 L 827.0407162817189 388.6459003595" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="577.3600462823829" y="393.04383970950005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="577.3600462823829" y="401.83971840950005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="706.4517226537175" y="422.9498272895" width="85.07527178871094" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="706.4517226537175" y="431.7457059895" width="354.16561907875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.7711044587176" y="430.86611811949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.7711044587176" y="439.66199681949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Bob's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 443.1803482995 L 1063.7838580644675 443.1803482995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1071.0257981941343,443.1803482995) translate(-1071.0257981941343,-443.1803482995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1063.6958992774676 439.51539884116664 L 1071.0257981941343 443.1803482995 L 1063.6958992774676 446.84529775783335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1081.434254655801" y="456.37416634949994" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1081.434254655801" y="465.17004504949995" width="372.052093688125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1082.7536364608009" y="464.2904571794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1082.7536364608009" y="473.0863358794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=realm-management, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1071.0257981941343 476.60468735949996 L 1456.652864675926 476.60468735949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1463.8948048055927,476.60468735949996) translate(-1463.8948048055927,-476.60468735949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1456.564905888926 472.9397379011666 L 1463.8948048055927 476.60468735949996 L 1456.564905888926 480.2696368178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1145.9637193774806" y="489.79850540949997" width="242.99316424476564" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1147.2831011824806" y="497.71479623949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1463.8948048055927 501.2331477195 L 1078.267738323801 501.2331477195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1071.0257981941343,501.2331477195) translate(-1071.0257981941343,-501.2331477195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1078.355697110801 497.56819826116663 L 1071.0257981941343 501.2331477195 L 1078.355697110801 504.89809717783334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1117.5967302417384" y="514.4269657695" width="139.0444948111719" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1117.5967302417384" y="523.2228444695" width="299.72714251625" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1118.9161120467384" y="522.3432565995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Bob's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1118.9161120467384" y="531.1391352995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Bob's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1071.0257981941343 534.6574867795 L 1456.652864675926 534.6574867795" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1463.8948048055927,534.6574867795) translate(-1463.8948048055927,-534.6574867795)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1456.564905888926 530.9925373211667 L 1463.8948048055927 534.6574867795 L 1456.564905888926 538.3224362378334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1207.960766801797" y="547.8513048295" width="118.99906939613281" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1209.280148606797" y="555.7675956595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Bob's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1463.8948048055927 559.2859471395 L 1078.267738323801 559.2859471395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1071.0257981941343,559.2859471395) translate(-1071.0257981941343,-559.2859471395)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1078.355697110801 555.6209976811666 L 1071.0257981941343 559.2859471395 L 1078.355697110801 562.9508965978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="734.973573239655" y="572.4797651895" width="103.22596758949219" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="734.973573239655" y="581.2756438895" width="84.250824156875" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="734.973573239655" y="590.0715225895" width="297.121917906875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="736.2929550446551" y="580.3960560195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="736.2929550446551" y="589.1919347195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Bob's user_claims)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="736.2929550446551" y="597.9878134195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1071.0257981941343 601.5061648994999 L 703.2852063217175 601.5061648994999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,601.5061648994999) translate(-696.0432661920509,-601.5061648994999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 703.3731651087176 597.8412154411666 L 696.0432661920509 601.5061648994999 L 703.3731651087176 605.1711143578333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="388.86308123214855" y="614.6999829494999" width="98.06091326820312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="388.86308123214855" y="623.4958616495" width="157.91487139808595" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.1824630371485" y="622.6162737794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.1824630371485" y="631.4121524794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 634.9305039594999 L 246.8397077999987 634.9305039594999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(239.59776767033205,634.9305039594999) translate(-239.59776767033205,-634.9305039594999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 246.92766658699873 631.2655545011665 L 239.59776767033205 634.9305039594999 L 246.92766658699873 638.5954534178333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 63.95226917978516 648.1243220094999 L 407.32697533087895 648.1243220094999 L 415.24326616087893 656.0406128394999 L 415.24326616087893 685.9466004194999 L 63.95226917978516 685.9466004194999 L 63.95226917978516 648.1243220094999 M 407.32697533087895 648.1243220094999 L 407.32697533087895 656.0406128394999 L 415.24326616087893 656.0406128394999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="76.26649935978517" y="660.4385521894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="76.26649935978517" y="669.2344308894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="76.26649935978517" y="678.0303095894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 48.50942860361329 722.8892909594998 L 422.7698159070508 722.8892909594998 L 430.6861067370508 730.8055817894998 L 430.6861067370508 813.4868415694998 L 48.50942860361329 813.4868415694998 L 48.50942860361329 722.8892909594998 M 422.7698159070508 722.8892909594998 L 422.7698159070508 730.8055817894998 L 430.6861067370508 730.8055817894998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="735.2035211394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="743.9993998394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="752.7952785394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="761.5911572394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="770.3870359394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="779.1829146394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="787.9787933394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="796.7746720394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="805.5705507394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="434.09860827072276" y="839.8744776694998" width="67.4438173209375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="435.41799007572274" y="847.7907684994998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 239.59776767033205 851.3091199794998 L 688.8013260623842 851.3091199794998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,851.3091199794998) translate(-696.0432661920509,-851.3091199794998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 688.7133672753841 847.6441705211664 L 696.0432661920509 851.3091199794998 L 688.7133672753841 854.9740694378331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="476.27177606248057" y="864.5029380294998" width="187.37963885414064" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="476.27177606248057" y="873.2988167294998" width="27.507705870742186" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="477.59115786748055" y="872.4192288594998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Get data from Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="477.59115786748055" y="881.2151075594998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 696.0432661920509 884.7334590394997 L 451.12186491671747 884.7334590394997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(443.8799247870508,884.7334590394997) translate(-443.8799247870508,-884.7334590394997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 451.20982370371746 881.0685095811664 L 443.8799247870508 884.7334590394997 L 451.20982370371746 888.3984084978331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="545.0463045658985" y="897.9272770894997" width="49.830581847304686" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="546.3656863708985" y="905.8435679194997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 443.8799247870508 909.3619193994997 L 688.8013260623842 909.3619193994997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(696.0432661920509,909.3619193994997) translate(-696.0432661920509,-909.3619193994997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 688.7133672753841 905.6969699411663 L 696.0432661920509 909.3619193994997 L 688.7133672753841 913.026868857833 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.111489253613286 699.1404184694998 L 435.0840460870508 699.1404184694998 L 435.0840460870508 826.6806596194998 L 44.111489253613286 826.6806596194998 L 44.111489253613286 699.1404184694998 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.111489253613286 699.1404184694998 L 44.111489253613286 709.6954729094998 L 140.38334614091798 709.6954729094998 L 145.66087336091798 704.4179456894998 L 145.66087336091798 699.1404184694998 L 44.111489253613286 699.1404184694998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="52.90736795361329" y="706.1771214294998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g></g></g></svg>