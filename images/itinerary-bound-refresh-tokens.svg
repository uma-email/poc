<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1073" height="842"><desc>participant%20%22Client%22%20as%20client%0Aparticipant%20%22Authorization%20Server%20(AS)%22%20as%20AS%0A%0Abottomparticipants%0A%0Anote%20right%20of%20client%3AClient%3A%5Cn%E2%80%A2%20is%20registered%20at%20the%20AS%20as%20a%20confidential%20client%20and%20has%20a%20client%20secret%5Cn%E2%80%A2%20client%20has%20a%20valid%20Refresh%20Token%20issued%20by%20the%20AS%0Anote%20right%20of%20AS%3AAS%3A%5Cn%E2%80%A2%20issues%20opaque%20Refresh%20Tokens%20and%20Access%20Tokens%20using%20high%20entropy%20nonce%20data%20strings%0Aclient-%3Eclient%3A1.%20Client%3A%5Cn%20a)%20computes%20the%20destination%20Route-MAC%5Cn%20b)%20generates%20the%20destination%20Route-JWT%20with%20a%20payload%20including%5Cn%20%20%20%20%20the%20Refresh%20Token%20and%20a%20timestamp%20%0Anote%20right%20of%20client%3AThe%20Route-MAC%20is%20computed%20as%3A%5CnRoute-MAC%20%3D%20HMAC-SHA256(Key%2C%20message)%5Cnwhere%5CnKey%20%3D%20SHA256(client's%20client%20secret)%5Cnmessage%20%3D%20Refresh%20Token%0Anote%20right%20of%20client%3AThe%20Route-JWT%20is%20generated%20as%3A%5CnRoute-JWT%20%3D%20header%20%7C%7C%20%22.%22%20%7C%7C%20payload%20%7C%7C%20%22.%22%20%7C%7C%20signature%5Cnwhere%5Cnheader%20%3D%20base64url(%7B%22typ%22%3A%22JWT%22%2C%22alg%22%3A%22HS256%22%7D)%5Cnpayload%20%3D%20base64url(%7B%22token%22%3ARefresh%20Token%2C%22ts%22%3Atimestamp%7D)%5Cnsignature%20%3D%20base64url(HMAC-SHA256(Key%2C%20message))%5Cnwhere%5Cnmessage%20%3D%20header%20%7C%7C%20%22.%22%20%7C%7C%20payload%5CnKey%20%3D%20Route-MAC%0Aclient-%3EAS%3A2.%20Route%20JWT%0Anote%20right%20of%20client%3AClient%20sends%20the%20destination%20Route-JWT%20in%20the%20Authorization%20header%5Cnto%20authenticate%20itself%20to%20the%20AS%20token%20endpoint%0AAS-%3EAS%3A3.%20AS%3A%5Cn%20a)%20looks%20up%20the%20Refresh%20Token%20data%20using%20the%20token%20claim%20value%20from%20the%20Route-JWT%2C%20and%20checks%20the%20token%20state%5Cn%20b)%20computes%20the%20destination%20Itinerary-MAC%5Cn%20c)%20generates%20the%20destination%20Itinerary-JWT%20with%20the%20payload%20from%20the%20Route-JWT%5Cn%20d)%20compares%20the%20destination%20Itinerary-JWT%20signature%20with%20the%20Route-JWT%20signature%2C%20they%20are%20equal%2C%5Cn%20%20%20%20%20the%20Refresh%20Token%20route%20and%20the%20Route-JWT%20have%20been%20verified%2C%5Cn%20%20%20%20%20the%20AS%20validates%20the%20ts%20(timestamp)%20claim%20value%20from%20the%20Route-JWT%2C%20if%20valid%2C%5Cn%20%20%20%20%20the%20AS%20may%20generate%20and%20return%20a%20new%20Refresh%20Token%20and%20a%20new%20Access%20Token%0Anote%20right%20of%20AS%3AItinerary-MAC%20and%20Itinerary-JWT%20are%20computed%20and%20generated%20in%20an%20analogous%20manner%5Cnas%20Route-MAC%20and%20Route-JWT.%0Aclient%3C-AS%3A4.%20Refresh%20Token%20and%20Access%20Token%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1073" height="842"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 38.111285853 L 33.37474404576514 802.5988002930001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 453.5988942657651 38.111285853 L 453.5988942657651 802.5988002930001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.654493450000004 7.690111091999997 L 61.09499464153028 7.690111091999997 L 61.09499464153028 38.111285853 L 5.654493450000004 38.111285853 L 5.654493450000004 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="17.924744236500004" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 373.49530760280027 7.690111091999997 L 533.70248092873 7.690111091999997 L 533.70248092873 38.111285853 L 373.49530760280027 38.111285853 L 373.49530760280027 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="385.7655583893003" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization Server (AS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.654493450000004 802.5988002930001 L 61.09499464153028 802.5988002930001 L 61.09499464153028 833.019975054 L 5.654493450000004 833.019975054 L 5.654493450000004 802.5988002930001 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="17.924744236500004" y="821.7109881540001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 373.49530760280027 802.5988002930001 L 533.70248092873 802.5988002930001 L 533.70248092873 833.019975054 L 373.49530760280027 833.019975054 L 373.49530760280027 802.5988002930001 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="385.7655583893003" y="821.7109881540001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization Server (AS)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 85.043581488 L 39.029237495765145 85.043581488 M 39.029237495765145 60.729259653 L 437.7663126057651 60.729259653 L 447.9444008157651 70.907347863 L 447.9444008157651 109.357903323 L 39.029237495765145 109.357903323 L 39.029237495765145 60.729259653 M 437.7663126057651 60.729259653 L 437.7663126057651 70.907347863 L 447.9444008157651 70.907347863" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="76.561841313" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="87.87082821300001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the AS as a confidential client and has a client secret</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="99.17981511300002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client has a valid Refresh Token issued by the AS</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 453.5988942657651 144.981212058 L 459.25338771576514 144.981212058 M 459.25338771576514 126.32138367300001 L 959.0571437339682 126.32138367300001 L 969.2352319439683 136.499471883 L 969.2352319439683 163.641040443 L 459.25338771576514 163.641040443 L 459.25338771576514 126.32138367300001 M 959.0571437339682 126.32138367300001 L 959.0571437339682 136.499471883 L 969.2352319439683 136.499471883" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="475.0859693757651" y="142.153965333" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="475.0859693757651" y="153.462952233" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• issues opaque Refresh Tokens and Access Tokens using high entropy nonce data strings</text></g><g><g><rect fill="white" stroke="none" x="46.75704521076514" y="180.604520793" width="51.47602813176758" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="46.75704521076514" y="191.913507693" width="219.65935866765625" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="46.75704521076514" y="203.22249459300002" width="351.9927021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="46.75704521076514" y="214.53148149300003" width="213.14269607" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="48.45339324576514" y="190.782609003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="48.45339324576514" y="202.091595903" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> a) computes the destination Route-MAC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="48.45339324576514" y="213.40058280300002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> b) generates the destination Route-JWT with a payload including</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="48.45339324576514" y="224.70956970300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     the Refresh Token and a timestamp </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 229.233164463 L 78.61069164576514 229.233164463 L 78.61069164576514 243.93484743300002 L 42.685809926765145 243.93484743300002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(33.37474404576514,243.93484743300002) translate(-33.37474404576514,-243.93484743300002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 42.79889979576514 239.222769558 L 33.37474404576514 243.93484743300002 L 42.79889979576514 248.64692530800002 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 296.521636518 L 39.029237495765145 296.521636518 M 39.029237495765145 260.898327783 L 295.38298130693704 260.898327783 L 305.56106951693704 271.076415993 L 305.56106951693704 332.144945253 L 39.029237495765145 332.144945253 L 39.029237495765145 260.898327783 M 295.38298130693704 260.898327783 L 295.38298130693704 271.076415993 L 305.56106951693704 271.076415993" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576515" y="276.730909443" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The Route-MAC is computed as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576515" y="288.03989634299995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Route-MAC = HMAC-SHA256(Key, message)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576515" y="299.34888324299993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">where</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576515" y="310.6578701429999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Key = SHA256(client's client secret)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576515" y="321.9668570429999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">message = Refresh Token</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 407.349708138 L 39.029237495765145 407.349708138 M 39.029237495765145 349.108425603 L 395.199631697562 349.108425603 L 405.377719907562 359.286513813 L 405.377719907562 465.590990673 L 39.029237495765145 465.590990673 L 39.029237495765145 349.108425603 M 395.199631697562 349.108425603 L 395.199631697562 359.286513813 L 405.377719907562 359.286513813" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="364.94100726299996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The Route-JWT is generated as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="376.24999416299994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Route-JWT = header || "." || payload || "." || signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="387.5589810629999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">where</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="398.8679679629999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">header = base64url({"typ":"JWT","alg":"HS256"})</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="410.1769548629999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">payload = base64url({"token":Refresh Token,"ts":timestamp})</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="421.48594176299986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">signature = base64url(HMAC-SHA256(Key, message))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="432.79492866299984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">where</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="444.1039155629998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">message = header || "." || payload</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="455.4129024629998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Key = Route-MAC</text></g><g><g><rect fill="white" stroke="none" x="207.69880394547215" y="482.554471023" width="71.57603042058594" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="209.39515198047215" y="492.732559233" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Route JWT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 497.256153993 L 444.28782838476513 497.256153993" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(453.5988942657651,497.256153993) translate(-453.5988942657651,-497.256153993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 444.1747385157651 492.544076118 L 453.5988942657651 497.256153993 L 444.1747385157651 501.968231868 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 33.37474404576514 532.879462728 L 39.029237495765145 532.879462728 M 39.029237495765145 514.2196343429999 L 419.132981306937 514.2196343429999 L 429.311069516937 524.397722553 L 429.311069516937 551.539291113 L 39.029237495765145 551.539291113 L 39.029237495765145 514.2196343429999 M 419.132981306937 514.2196343429999 L 419.132981306937 524.397722553 L 429.311069516937 524.397722553" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="530.0522160030001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client sends the destination Route-JWT in the Authorization header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="54.86181915576512" y="541.3612029030002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to authenticate itself to the AS token endpoint</text></g><g><g><rect fill="white" stroke="none" x="466.9811954307651" y="568.502771463" width="34.64269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="579.8117583630001" width="602.3760334723438" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="591.1207452630001" width="233.9760243170703" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="602.4297321630002" width="432.3593708746875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="613.7387190630002" width="531.7927204840626" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="625.0477059630002" width="357.14269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="636.3566928630003" width="429.2926899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="466.9811954307651" y="647.6656797630003" width="438.7093769782031" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="578.6808596730001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. AS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="589.9898465730001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> a) looks up the Refresh Token data using the token claim value from the Route-JWT, and checks the token state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="601.2988334730002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> b) computes the destination Itinerary-MAC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="612.6078203730002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> c) generates the destination Itinerary-JWT with the payload from the Route-JWT</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="623.9168072730002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> d) compares the destination Itinerary-JWT signature with the Route-JWT signature, they are equal,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="635.2257941730003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     the Refresh Token route and the Route-JWT have been verified,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="646.5347810730003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     the AS validates the ts (timestamp) claim value from the Route-JWT, if valid,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="468.67754346576515" y="657.8437679730004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     the AS may generate and return a new Refresh Token and a new Access Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 453.5988942657651 662.367362733 L 498.83484186576516 662.367362733 L 498.83484186576516 677.069045703 L 462.9099601467651 677.069045703" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(453.5988942657651,677.069045703) translate(-453.5988942657651,-677.069045703)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 463.02305001576514 672.356967828 L 453.5988942657651 677.069045703 L 463.02305001576514 681.781123578 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 453.5988942657651 712.692354438 L 459.25338771576514 712.692354438 M 459.25338771576514 694.032526053 L 942.9071193199057 694.032526053 L 953.0852075299058 704.210614263 L 953.0852075299058 731.352182823 L 459.25338771576514 731.352182823 L 459.25338771576514 694.032526053 M 942.9071193199057 694.032526053 L 942.9071193199057 704.210614263 L 953.0852075299058 704.210614263" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="475.0859693757651" y="709.8651077130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Itinerary-MAC and Itinerary-JWT are computed and generated in an analogous manner</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="475.0859693757651" y="721.1740946130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">as Route-MAC and Route-JWT.</text></g><g><g><rect fill="white" stroke="none" x="149.37380699722996" y="748.3156631730001" width="188.2260243170703" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="151.07015503222996" y="758.4937513830001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Refresh Token and Access Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 453.5988942657651 763.017346143 L 42.685809926765145 763.017346143" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(33.37474404576514,763.017346143) translate(-33.37474404576514,-763.017346143)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 42.79889979576514 758.3052682680001 L 33.37474404576514 763.017346143 L 42.79889979576514 767.729424018 Z"/></g></g></g></g></svg>