<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1573" height="997"><desc>Title%20UMA-compliant%20communications%20platform%20-%20Alice%20to%20Bob%20(push%20data)%0A%0Aactor%20%22Alice%20(RqP)%5Cnalice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22IAM%20Server%5Cnfoo.com%22%20as%20authServer%20%23lightpink%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnfoo.com%22%20as%20claimsProvider%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnfoo.com%22%20as%20rqpClient%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnbar.com%22%20as%20rsServer%20%23lightsteelblue%0Aparticipant%20%22UMA%20Server%5Cnbar.com%22%20as%20asServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RO)%5Cnbob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Ffoo.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Alice's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20foo.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20bar.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20foo.com%20IAM%20Server%0Anote%20over%20rsServer%3Abar.com%20admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%5Cn'Incoming'%20at%20the%20bar.com%20UMA%20Server%20with%20the%20associated%20scope%20'create'%0AAlice-%3ErqpClient%3AInitiate%20request%0ArqpClient-%3ErsServer%3A1.%20Request%20Bob's%20'Incoming'%20resource%5Cn(scope%3Dcreate)%0ArqpClient%3C-rsServer%3A2.%20401%20with%20permission%20ticket%0AauthServer%3C-rqpClient%3A3.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0AauthServer-%3ErqpClient%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Alice's%20email_address%2C%20ticket_challenge)%0AauthServer%3C-claimsProvider%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Drealm-management%2C%20role%3Dquery-users%2C%20view-users)%0AauthServer-%3EclaimsProvider%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Alice's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Alice's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Alice's%20user_claims%0A%0AclaimsProvider-%3ErqpClient%3A12.%20Return%20claims_token%5Cn(Alice's%20user_claims)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArqpClient-%3ErsServer%3A15.%20Post%20data%20into%20Bob's%20'Incoming'%20resource%5Cn(RPT)%0ArqpClient%3C-rsServer%3A16.%20201%20Created</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1573" height="997"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="10.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="578.2745602722046" y="13.19381805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA-compliant communications platform - Alice to Bob (push data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 35.31561055361328 78.15138224949999 L 35.31561055361328 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 107.8975713540508 78.15138224949999 L 107.8975713540508 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 500.76657796550916 78.15138224949999 L 500.76657796550916 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 78.15138224949999 L 879.3701426824363 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1131.5334840874364 78.15138224949999 L 1131.5334840874364 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1335.815641204155 78.15138224949999 L 1335.815641204155 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1540.0977983208738 78.15138224949999 L 1540.0977983208738 940.1474948494997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 32.143922998476604 M 35.31561055361328 37.16258750749999 L 35.31561055361328 47.893559521499995 M 28.98257788961328 41.03277413549999 L 41.648643217613284 41.03277413549999 M 35.31561055361328 47.893559521499995 L 28.98257788961328 57.92086123949999 M 35.31561055361328 47.893559521499995 L 41.648643217613284 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="11.731099750390626" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 75.02916045722657 45.694589846499994 L 140.76598225087503 45.694589846499994 L 140.76598225087503 78.15138224949999 L 75.02916045722657 78.15138224949999 L 75.02916045722657 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="84.57268884672658" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.30688074125783" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 447.4268230745443 45.694589846499994 L 554.106332856474 45.694589846499994 L 554.106332856474 78.15138224949999 L 447.4268230745443 78.15138224949999 L 447.4268230745443 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="456.9703514640443" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="484.1758873527162" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 847.5333632553386 45.694589846499994 L 911.2069221095339 45.694589846499994 L 911.2069221095339 78.15138224949999 L 847.5333632553386 78.15138224949999 L 847.5333632553386 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="857.0768916448386" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="862.7794520696433" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1076.11449030487 45.694589846499994 L 1186.952477870003 45.694589846499994 L 1186.952477870003 78.15138224949999 L 1076.11449030487 78.15138224949999 L 1076.11449030487 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1085.65801869437" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1114.9428545097996" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1300.874819723835 45.694589846499994 L 1370.7564626844755 45.694589846499994 L 1370.7564626844755 78.15138224949999 L 1300.874819723835 78.15138224949999 L 1300.874819723835 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1310.4183481133348" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1319.2250116265184" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1545.111449179874 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 1545.1114466730487 32.143922998476604 M 1540.0977983208738 37.16258750749999 L 1540.0977983208738 47.893559521499995 M 1533.7647656568738 41.03277413549999 L 1546.4308309848739 41.03277413549999 M 1540.0977983208738 47.893559521499995 L 1533.7647656568738 57.92086123949999 M 1540.0977983208738 47.893559521499995 L 1546.4308309848739 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1520.4007692071043" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1510.9907045098387" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 966.1393164079997 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 966.1343027579762 M 35.31561055361328 971.1529672669997 L 35.31561055361328 981.8839392809997 M 28.98257788961328 975.0231538949997 L 41.648643217613284 975.0231538949997 M 35.31561055361328 981.8839392809997 L 28.98257788961328 991.9112409989997 M 35.31561055361328 981.8839392809997 L 41.648643217613284 991.9112409989997" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="11.731099750390626" y="948.9433735494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="957.7392522494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 75.02916045722657 940.1474948494997 L 140.76598225087503 940.1474948494997 L 140.76598225087503 972.6042872524997 L 75.02916045722657 972.6042872524997 L 75.02916045722657 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="84.57268884672658" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.30688074125783" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 447.4268230745443 940.1474948494997 L 554.106332856474 940.1474948494997 L 554.106332856474 972.6042872524997 L 447.4268230745443 972.6042872524997 L 447.4268230745443 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="456.9703514640443" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="484.1758873527162" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 847.5333632553386 940.1474948494997 L 911.2069221095339 940.1474948494997 L 911.2069221095339 972.6042872524997 L 847.5333632553386 972.6042872524997 L 847.5333632553386 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="857.0768916448386" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="862.7794520696433" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1076.11449030487 940.1474948494997 L 1186.952477870003 940.1474948494997 L 1186.952477870003 972.6042872524997 L 1076.11449030487 972.6042872524997 L 1076.11449030487 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1085.65801869437" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1114.9428545097996" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1300.874819723835 940.1474948494997 L 1370.7564626844755 940.1474948494997 L 1370.7564626844755 972.6042872524997 L 1300.874819723835 972.6042872524997 L 1300.874819723835 940.1474948494997 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1310.4183481133348" y="955.0125298524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1319.2250116265184" y="963.8084085524997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1545.111449179874 966.1393164079997 A 5.013650858999999 5.013650858999999 0 1 1 1545.1114466730487 966.1343027579762 M 1540.0977983208738 971.1529672669997 L 1540.0977983208738 981.8839392809997 M 1533.7647656568738 975.0231538949997 L 1546.4308309848739 975.0231538949997 M 1540.0977983208738 981.8839392809997 L 1533.7647656568738 991.9112409989997 M 1540.0977983208738 981.8839392809997 L 1546.4308309848739 991.9112409989997" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1520.4007692071043" y="948.9433735494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1510.9907045098387" y="957.7392522494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 192.2907572093373 95.7431396495 L 801.326107891681 95.7431396495 L 809.242398721681 103.65943047949999 L 809.242398721681 133.5654180595 L 192.2907572093373 133.5654180595 L 192.2907572093373 95.7431396495 M 801.326107891681 95.7431396495 L 801.326107891681 103.65943047949999 L 809.242398721681 103.65943047949999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="204.60498738933728" y="108.0573698295" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="204.60498738933728" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="370.6850502555482" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="375.8683693473451" y="116.85324852950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="204.60498738933728" y="125.64912722950001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Alice's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 631.6047406274363 146.7592361095 L 1119.2192539074363 146.7592361095 L 1127.1355447374362 154.6755269395 L 1127.1355447374362 184.5815145195 L 631.6047406274363 184.5815145195 L 631.6047406274363 146.7592361095 M 1119.2192539074363 146.7592361095 L 1119.2192539074363 154.6755269395 L 1127.1355447374362 154.6755269395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="643.9189708074363" y="159.0734662895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="643.9189708074363" y="167.8693449895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at foo.com IAM Server and pre-registered as a universal AEMS public client at bar.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="643.9189708074363" y="176.6652236895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at foo.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 967.1929935314598 197.7753325695 L 1287.957683813413 197.7753325695 L 1295.873974643413 205.6916233995 L 1295.873974643413 226.8017322795 L 967.1929935314598 226.8017322795 L 967.1929935314598 197.7753325695 M 1287.957683813413 197.7753325695 L 1287.957683813413 205.6916233995 L 1295.873974643413 205.6916233995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="979.5072237114598" y="210.08956274949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com admin has set up the Resource Server and registers it's resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="979.5072237114598" y="218.88544144949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Incoming' at the bar.com UMA Server with the associated scope 'create'</text></g><g><g><rect fill="white" stroke="none" x="425.42919549661855" y="239.9955503295" width="63.8273622428125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="426.7485773016185" y="247.9118411595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 35.31561055361328 251.43019263949998 L 872.1282025527696 251.43019263949998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,251.43019263949998) translate(-879.3701426824363,-251.43019263949998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 872.0402437657696 247.76524318116665 L 879.3701426824363 251.43019263949998 L 872.0402437657696 255.0951420978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="927.3142171634323" y="264.6240106894999" width="156.27519244300782" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="927.3142171634323" y="273.41988938949993" width="65.1163026725" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="928.6335989684324" y="272.5403015194999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="928.6335989684324" y="281.3361802194999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=create)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 284.85453169949994 L 1124.2915439577696 284.85453169949994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1131.5334840874364,284.85453169949994) translate(-1131.5334840874364,-284.85453169949994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1124.2035851707697 281.1895822411666 L 1131.5334840874364 284.85453169949994 L 1124.2035851707697 288.5194811578333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="945.5468908084518" y="298.04834974949995" width="119.80984515296875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="946.8662726134519" y="305.9646405794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1131.5334840874364 309.48299205949996 L 886.6120828121029 309.48299205949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,309.48299205949996) translate(-879.3701426824363,-309.48299205949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 886.700041599103 305.8180426011666 L 879.3701426824363 309.48299205949996 L 886.700041599103 313.1479415178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="379.02635875816543" y="322.67681010949997" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="379.02635875816543" y="331.47268880949997" width="229.21499652015626" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.3457405631654" y="330.59310093949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.3457405631654" y="339.38897963949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 342.9073311195 L 115.13951148371746 342.9073311195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(107.8975713540508,342.9073311195) translate(-107.8975713540508,-342.9073311195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 115.22747027071746 339.24238166116663 L 107.8975713540508 342.9073311195 L 115.22747027071746 346.57228057783334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="380.9575568782826" y="356.1011491695" width="225.3526002799219" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="382.2769386832826" y="364.01743999949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 107.8975713540508 367.5357914795 L 872.1282025527696 367.5357914795" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,367.5357914795) translate(-879.3701426824363,-367.5357914795)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 872.0402437657696 363.87084202116665 L 879.3701426824363 367.5357914795 L 872.0402437657696 371.20074093783336 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 748.3726925927683 380.7296095295 L 1002.4513019421042 380.7296095295 L 1010.3675927721042 388.6459003595 L 1010.3675927721042 409.75600923950003 L 748.3726925927683 409.75600923950003 L 748.3726925927683 380.7296095295 M 1002.4513019421042 380.7296095295 L 1002.4513019421042 388.6459003595 L 1010.3675927721042 388.6459003595" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="760.6869227727683" y="393.04383970950005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="760.6869227727683" y="401.83971840950005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="511.17503442717583" y="422.9498272895" width="85.07527178871094" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="511.17503442717583" y="431.7457059895" width="357.78665179359376" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.4944162321758" y="430.86611811949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.4944162321758" y="439.66199681949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Alice's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 443.1803482995 L 508.0085180951758 443.1803482995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(500.76657796550916,443.1803482995) translate(-500.76657796550916,-443.1803482995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 508.0964768821758 439.51539884116664 L 500.76657796550916 443.1803482995 L 508.0964768821758 446.84529775783335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="118.3060278157175" y="456.37416634949994" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="118.3060278157175" y="465.17004504949995" width="372.052093688125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.6254096207175" y="464.2904571794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.6254096207175" y="473.0863358794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=realm-management, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 500.76657796550916 476.60468735949996 L 115.13951148371746 476.60468735949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(107.8975713540508,476.60468735949996) translate(-107.8975713540508,-476.60468735949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 115.22747027071746 472.9397379011666 L 107.8975713540508 476.60468735949996 L 115.22747027071746 480.2696368178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="182.8354925373972" y="489.79850540949997" width="242.99316424476564" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="184.1548743423972" y="497.71479623949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 107.8975713540508 501.2331477195 L 493.5246378358425 501.2331477195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(500.76657796550916,501.2331477195) translate(-500.76657796550916,-501.2331477195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 493.4366790488425 497.56819826116663 L 500.76657796550916 501.2331477195 L 493.4366790488425 504.89809717783334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="152.65798704423312" y="514.4269657695" width="142.66552752601564" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="152.65798704423312" y="523.2228444695" width="303.34817523109376" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="153.97736884923313" y="522.3432565995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Alice's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="153.97736884923313" y="531.1391352995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Alice's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 500.76657796550916 534.6574867795 L 115.13951148371746 534.6574867795" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(107.8975713540508,534.6574867795) translate(-107.8975713540508,-534.6574867795)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 115.22747027071746 530.9925373211667 L 107.8975713540508 534.6574867795 L 115.22747027071746 538.3224362378334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="243.02202360429172" y="547.8513048295" width="122.62010211097656" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="244.34140540929172" y="555.7675956595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Alice's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 107.8975713540508 559.2859471395 L 493.5246378358425 559.2859471395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(500.76657796550916,559.2859471395) translate(-500.76657796550916,-559.2859471395)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 493.4366790488425 555.6209976811666 L 500.76657796550916 559.2859471395 L 493.4366790488425 562.9508965978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="541.5074013705351" y="572.4797651895" width="103.22596758949219" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="541.5074013705351" y="581.2756438895" width="87.87185687171875" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="541.5074013705351" y="590.0715225895" width="297.121917906875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="542.8267831755352" y="580.3960560195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="542.8267831755352" y="589.1919347195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Alice's user_claims)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="542.8267831755352" y="597.9878134195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 500.76657796550916 601.5061648994999 L 872.1282025527696 601.5061648994999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,601.5061648994999) translate(-879.3701426824363,-601.5061648994999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 872.0402437657696 597.8412154411666 L 879.3701426824363 601.5061648994999 L 872.0402437657696 605.1711143578333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1028.6354562442527" y="614.6999829494999" width="98.06091326820312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1028.6354562442527" y="623.4958616495" width="157.91487139808595" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1029.9548380492527" y="622.6162737794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1029.9548380492527" y="631.4121524794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 634.9305039594999 L 1328.5737010744883 634.9305039594999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1335.815641204155,634.9305039594999) translate(-1335.815641204155,-634.9305039594999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1328.4857422874884 631.2655545011665 L 1335.815641204155 634.9305039594999 L 1328.4857422874884 638.5954534178333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1160.1701427136081 648.1243220094999 L 1503.5448488647019 648.1243220094999 L 1511.4611396947018 656.0406128394999 L 1511.4611396947018 685.9466004194999 L 1160.1701427136081 685.9466004194999 L 1160.1701427136081 648.1243220094999 M 1503.5448488647019 648.1243220094999 L 1503.5448488647019 656.0406128394999 L 1511.4611396947018 656.0406128394999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1172.4843728936082" y="660.4385521894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1172.4843728936082" y="669.2344308894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1172.4843728936082" y="678.0303095894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1144.7273021374363 722.8892909594998 L 1518.9876894408737 722.8892909594998 L 1526.9039802708737 730.8055817894998 L 1526.9039802708737 813.4868415694998 L 1144.7273021374363 813.4868415694998 L 1144.7273021374363 722.8892909594998 M 1518.9876894408737 722.8892909594998 L 1518.9876894408737 730.8055817894998 L 1526.9039802708737 730.8055817894998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="735.2035211394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="743.9993998394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="752.7952785394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="761.5911572394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="770.3870359394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="779.1829146394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="787.9787933394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="796.7746720394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1157.0415323174363" y="805.5705507394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="1073.870983282827" y="839.8744776694998" width="67.4438173209375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1075.1903650878269" y="847.7907684994998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1335.815641204155 851.3091199794998 L 886.6120828121029 851.3091199794998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,851.3091199794998) translate(-879.3701426824363,-851.3091199794998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 886.700041599103 847.6441705211664 L 879.3701426824363 851.3091199794998 L 886.700041599103 854.9740694378331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="913.5702367557175" y="864.5029380294998" width="183.7631532584375" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="913.5702367557175" y="873.2988167294998" width="27.507705870742186" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="914.8896185607175" y="872.4192288594998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Post data into Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="914.8896185607175" y="881.2151075594998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 879.3701426824363 884.7334590394997 L 1124.2915439577696 884.7334590394997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1131.5334840874364,884.7334590394997) translate(-1131.5334840874364,-884.7334590394997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1124.2035851707697 881.0685095811664 L 1131.5334840874364 884.7334590394997 L 1124.2035851707697 888.3984084978331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="970.682304931987" y="897.9272770894997" width="69.53901690589844" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="972.001686736987" y="905.8435679194997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 201 Created</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1131.5334840874364 909.3619193994997 L 886.6120828121029 909.3619193994997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(879.3701426824363,909.3619193994997) translate(-879.3701426824363,-909.3619193994997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 886.700041599103 905.6969699411663 L 879.3701426824363 909.3619193994997 L 886.700041599103 913.026868857833 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1140.3293627874364 699.1404184694998 L 1531.3019196208738 699.1404184694998 L 1531.3019196208738 826.6806596194998 L 1140.3293627874364 826.6806596194998 L 1140.3293627874364 699.1404184694998 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1140.3293627874364 699.1404184694998 L 1140.3293627874364 709.6954729094998 L 1236.601219674741 709.6954729094998 L 1241.878746894741 704.4179456894998 L 1241.878746894741 699.1404184694998 L 1140.3293627874364 699.1404184694998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1149.1252414874364" y="706.1771214294998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g></g></g></svg>