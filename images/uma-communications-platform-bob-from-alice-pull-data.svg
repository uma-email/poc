<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1588" height="1168"><desc>Title%20UMA%20communications%20platform%20-%20Bob%20from%20Alice%20(pull%20data)%0A%0Aactor%20%22Alice%20(RO)%5Cnalice%40gmail.com%20or%20alice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22UMA%20Server%5Cnfoo.com%22%20as%20asServer%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnfoo.com%22%20as%20rsServer%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnbar.com%22%20as%20rqpClient%20%23lightsteelblue%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnbar.com%22%20as%20claimsProvider%20%23lightsteelblue%0Aparticipant%20%22SMTP%20Server%5Cnoutlook.com%22%20as%20smtpServer%20%2300a2ed%0Aparticipant%20%22IMAP%20Server%5Cnoutlook.com%22%20as%20imapServer%20%2300a2ed%0Aparticipant%20%22IAM%20Server%5Cnbar.com%22%20as%20authServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RqP)%5Cnbob%40outlook.com%20or%20bob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Aopt%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0Anote%20over%20Bob%3AIf%20Bob%20uses%20an%20email%20provider%20(outlook)%20that%20does%20not%20support%5Cnthe%20WebFinger%20protocol%2C%20he%20must%20set%20up%20his%20email%20address%20to%20automatically%5Cnforward%20emails%20sent%20from%20challenge%40bar.com%20to%20response%40bar.com%0Aend%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Fbar.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Bob's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%5Cn%E2%80%A2%20can%20send%20email%20messages%20from%20address%20challenge%40bar.com%20and%20retrieve%20from%20response%40bar.com%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20bar.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20foo.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20bar.com%20IAM%20Server%0Anote%20over%20rsServer%3Afoo.com%20admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%5Cn'Outgoing'%20at%20the%20foo.com%20UMA%20Server%20with%20the%20associated%20scopes%20'query'%2C%20'view'%0ArqpClient%3C-Bob%3AInitiate%20request%0ArsServer%3C-rqpClient%3A1.%20Request%20Alice's%20'Outgoing'%20resource%5Cn(scope%3Dquery%2C%20view)%0ArsServer-%3ErqpClient%3A2.%20401%20with%20permission%20ticket%0ArqpClient-%3EauthServer%3A3.%20b)%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0ArqpClient%3C-authServer%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Bob's%20email_address%2C%20ticket_challenge)%0AclaimsProvider-%3EauthServer%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Drealm-management%2C%20role%3Dquery-users%2C%20view-users)%0AclaimsProvider%3C-authServer%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Bob's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Bob's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Bob's%20user_claims%0A%0Aopt%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0AsmtpServer%3C-claimsProvider%3A10.%20Send%20plain_message%20from%20challenge%40bar.com%20to%20bob%40outlook.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0AimapServer-%3EclaimsProvider%3A11.%20Retrieve%20dkim_signed_message%20sent%20from%20bob%40outlook.com%20to%20response%40bar.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0Aend%0ArqpClient%3C-claimsProvider%3A12.%20Return%20claims_token%5Cn(Bob's%20user_claims%2C%20dkim_signed_message%20-%20optional)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Aalt%20Domain%20part%20of%20email_address%20or%20WebFinger%20is%20used%20to%20locate%20Claims%20Provider%20configuration%20url%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aelse%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0Anote%20over%20asServer%3A1.%20extract%20dkim_signed%20_message%20from%20claims_token%5Cn2.%20verify%20DKIM%20signature%20of%20dkim_signed%20_message%5Cn3.%20extract%20'From%3A'%20part%20of%20dkim_signed_message%20e.g.%20Bob%20Sanders%20%3Cbob%40outlook.com%3E%5Cn4.%20extract%20claims_provider_configuration_url%20and%20ticket_challenge%20from%20dkim_signed_message%5Cn5.%20verify%20claims_token%20signature%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20extract%20user_claims%20from%20claims_token%5Cn8.%20evaluate%20user_claims%5Cn9.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArsServer%3C-rqpClient%3A15.%20Get%20data%20from%20Alice's%20'Outgoing'%20resource%5Cn(RPT)%0ArsServer-%3ErqpClient%3A16.%20200%20OK</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1588" height="1168"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="665.3597390909745" y="11.3089869" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA communications platform - Bob from Alice (pull data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 56.02837506855469 66.98689907100001 L 56.02837506855469 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 223.62204862574214 66.98689907100001 L 223.62204862574214 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 391.2157221829296 66.98689907100001 L 391.2157221829296 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 66.98689907100001 L 573.5504792061326 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 844.4932659487108 66.98689907100001 L 844.4932659487108 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1076.8113883846484 66.98689907100001 L 1076.8113883846484 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1215.654531633867 66.98689907100001 L 1215.654531633867 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1326.139848260738 66.98689907100001 L 1326.139848260738 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1457.0844483775936 66.98689907100001 L 1457.0844483775936 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 60.32579009055469 27.556231413000003 A 4.297415022 4.297415022 0 1 1 60.32578794184735 27.551933998694235 M 56.02837506855469 31.853646435 L 56.02837506855469 41.051622447 M 50.60006135655469 35.170949259000004 L 61.456688780554686 35.170949259000004 M 56.02837506855469 41.051622447 L 50.60006135655469 49.646452491000005 M 56.02837506855469 41.051622447 L 61.456688780554686 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="40.68129865253906" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3.7696623000000002" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com or alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 197.31920077067963 39.16679129700001 L 249.92489648080462 39.16679129700001 L 249.92489648080462 66.98689907100001 L 197.31920077067963 66.98689907100001 L 197.31920077067963 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="205.49936796167964" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.78347898462886" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 350.3003254997421 39.16679129700001 L 432.1311188661171 39.16679129700001 L 432.1311188661171 66.98689907100001 L 350.3003254997421 66.98689907100001 L 350.3003254997421 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="358.4804926907421" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="379.3771525418163" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 549.4625895419881 39.16679129700001 L 597.6383688702772 39.16679129700001 L 597.6383688702772 66.98689907100001 L 549.4625895419881 66.98689907100001 L 549.4625895419881 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="557.6427567329881" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="561.7120163765428" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 805.061549990621 39.16679129700001 L 883.9249819068007 39.16679129700001 L 883.9249819068007 66.98689907100001 L 805.061549990621 66.98689907100001 L 805.061549990621 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="813.241717181621" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.654803119121" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1048.659221071578 39.16679129700001 L 1104.9635556977187 39.16679129700001 L 1104.9635556977187 66.98689907100001 L 1048.659221071578 66.98689907100001 L 1048.659221071578 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1056.839388262578" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.867464434453" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1188.6106559467732 39.16679129700001 L 1242.6984073209608 39.16679129700001 L 1242.6984073209608 66.98689907100001 L 1188.6106559467732 66.98689907100001 L 1188.6106559467732 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1196.7908231377733" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1197.7106076836717" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1301.3158059476677 39.16679129700001 L 1350.9638905738084 39.16679129700001 L 1350.9638905738084 66.98689907100001 L 1301.3158059476677 66.98689907100001 L 1301.3158059476677 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1309.4959731386678" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.3013854311482" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1461.3818633995936 27.556231413000003 A 4.297415022 4.297415022 0 1 1 1461.3818612508862 27.551933998694235 M 1457.0844483775936 31.853646435 L 1457.0844483775936 41.051622447 M 1451.6561346655935 35.170949259000004 L 1462.5127620895937 35.170949259000004 M 1457.0844483775936 41.051622447 L 1451.6561346655935 49.646452491000005 M 1457.0844483775936 41.051622447 L 1462.5127620895937 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1441.5472398204647" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.6308350963436" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com or bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 60.32579009055469 1141.001384964 A 4.297415022 4.297415022 0 1 1 60.32578794184735 1140.9970875496942 M 56.02837506855469 1145.298799986 L 56.02837506855469 1154.496775998 M 50.60006135655469 1148.61610281 L 61.456688780554686 1148.61610281 M 56.02837506855469 1154.496775998 L 50.60006135655469 1163.091606042 M 56.02837506855469 1154.496775998 L 61.456688780554686 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="40.68129865253906" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3.7696623000000002" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com or alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 197.31920077067963 1118.7226807710001 L 249.92489648080462 1118.7226807710001 L 249.92489648080462 1146.5427885450001 L 197.31920077067963 1146.5427885450001 L 197.31920077067963 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="205.49936796167964" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.78347898462886" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 350.3003254997421 1118.7226807710001 L 432.1311188661171 1118.7226807710001 L 432.1311188661171 1146.5427885450001 L 350.3003254997421 1146.5427885450001 L 350.3003254997421 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="358.4804926907421" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="379.3771525418163" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 549.4625895419881 1118.7226807710001 L 597.6383688702772 1118.7226807710001 L 597.6383688702772 1146.5427885450001 L 549.4625895419881 1146.5427885450001 L 549.4625895419881 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="557.6427567329881" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="561.7120163765428" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 805.061549990621 1118.7226807710001 L 883.9249819068007 1118.7226807710001 L 883.9249819068007 1146.5427885450001 L 805.061549990621 1146.5427885450001 L 805.061549990621 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="813.241717181621" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.654803119121" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1048.659221071578 1118.7226807710001 L 1104.9635556977187 1118.7226807710001 L 1104.9635556977187 1146.5427885450001 L 1048.659221071578 1146.5427885450001 L 1048.659221071578 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1056.839388262578" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1058.867464434453" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1188.6106559467732 1118.7226807710001 L 1242.6984073209608 1118.7226807710001 L 1242.6984073209608 1146.5427885450001 L 1188.6106559467732 1146.5427885450001 L 1188.6106559467732 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1196.7908231377733" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1197.7106076836717" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1301.3158059476677 1118.7226807710001 L 1350.9638905738084 1118.7226807710001 L 1350.9638905738084 1146.5427885450001 L 1301.3158059476677 1146.5427885450001 L 1301.3158059476677 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1309.4959731386678" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1314.3013854311482" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1461.3818633995936 1141.001384964 A 4.297415022 4.297415022 0 1 1 1461.3818612508862 1140.9970875496942 M 1457.0844483775936 1145.298799986 L 1457.0844483775936 1154.496775998 M 1451.6561346655935 1148.61610281 L 1462.5127620895937 1148.61610281 M 1457.0844483775936 1154.496775998 L 1451.6561346655935 1163.091606042 M 1457.0844483775936 1154.496775998 L 1462.5127620895937 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1441.5472398204647" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.6308350963436" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com or bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1337.448835160738 102.421724691 L 1569.9346694544488 102.421724691 L 1576.720061594449 109.207116831 L 1576.720061594449 134.840820471 L 1337.448835160738 134.840820471 L 1337.448835160738 102.421724691 M 1569.9346694544488 102.421724691 L 1569.9346694544488 109.207116831 L 1576.720061594449 109.207116831" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.0038896007381" y="112.97677913099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Bob uses an email provider (outlook) that does not support</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.0038896007381" y="120.51610373099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the WebFinger protocol, he must set up his email address to automatically</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.0038896007381" y="128.05542833099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">forward emails sent from challenge@bar.com to response@bar.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 623.8991184911328 157.458794271 L 1058.3020212662889 157.458794271 L 1065.087413406289 164.244186411 L 1065.087413406289 197.417214651 L 623.8991184911328 197.417214651 L 623.8991184911328 157.458794271 M 1058.3020212662889 157.458794271 L 1058.3020212662889 164.244186411 L 1065.087413406289 164.244186411" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="634.4541729311327" y="168.01384871099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="634.4541729311327" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="752.9633739809374" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="756.662012896953" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="634.4541729311327" y="183.09249791099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Bob's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="634.4541729311327" y="190.63182251099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• can send email messages from address challenge@bar.com and retrieve from response@bar.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 394.98538448292953 208.72620155099997 L 745.3301817893358 208.72620155099997 L 752.1155739293358 215.51159369099997 L 752.1155739293358 241.145297331 L 394.98538448292953 241.145297331 L 394.98538448292953 208.72620155099997 M 745.3301817893358 208.72620155099997 L 745.3301817893358 215.51159369099997 L 752.1155739293358 215.51159369099997" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="405.5404389229295" y="219.28125599100002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="405.5404389229295" y="226.820580591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at bar.com IAM Server and pre-registered as a universal AEMS public client at foo.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="405.5404389229295" y="234.359905191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at bar.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 263.82202943726554 252.454284231 L 511.82402278859365 252.454284231 L 518.6094149285937 259.23967637100003 L 518.6094149285937 277.334055411 L 263.82202943726554 277.334055411 L 263.82202943726554 252.454284231 M 511.82402278859365 252.454284231 L 511.82402278859365 259.23967637100003 L 518.6094149285937 259.23967637100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="274.37708387726553" y="263.00933867099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com admin has set up the Resource Server and registers it's resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="274.37708387726553" y="270.54866327099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Outgoing' at the foo.com UMA Server with the associated scopes 'query', 'view'</text></g><g><g><rect fill="white" stroke="none" x="992.3554951555741" y="288.643042311" width="45.92393727257812" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="993.4863938455741" y="295.428434451" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1457.0844483775936 298.444164291 L 579.7578564601326 298.444164291" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,298.444164291) translate(-573.5504792061326,-298.444164291)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 579.8332497061326 295.302779041 L 573.5504792061326 298.444164291 L 579.8332497061326 301.585549541 Z"/></g></g><g><g><rect fill="white" stroke="none" x="425.1420945826561" y="309.75315119100003" width="114.48201222375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="425.1420945826561" y="317.292475791" width="61.514482926875" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="426.2729932726561" y="316.538543331" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="426.2729932726561" y="324.077867931" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=query, view)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 327.093597771 L 397.4230994369296 327.093597771" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(391.2157221829296,327.093597771) translate(-391.2157221829296,-327.093597771)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 397.4984926829296 323.95221252100004 L 391.2157221829296 327.093597771 L 397.4984926829296 330.234983021 Z"/></g></g><g><g><rect fill="white" stroke="none" x="439.4475068751366" y="338.402584671" width="85.87118763878907" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="440.57840556513656" y="345.187976811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 391.2157221829296 348.203706651 L 567.3431019521327 348.203706651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,348.203706651) translate(-573.5504792061326,-348.203706651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 567.2677087061327 345.062321401 L 573.5504792061326 348.203706651 L 567.2677087061327 351.345091901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="867.8756038495877" y="359.51269355100004" width="70.70936818078125" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="867.8756038495877" y="367.052018151" width="163.9391197676953" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="869.0065025395877" y="366.29808569100004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. b) Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="869.0065025395877" y="373.837410291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 376.85314013100003 L 1319.932471006738 376.85314013100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1326.139848260738,376.85314013100003) translate(-1326.139848260738,-376.85314013100003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1319.857077760738 373.71175488100005 L 1326.139848260738 376.85314013100003 L 1319.857077760738 379.994525381 Z"/></g></g><g><g><rect fill="white" stroke="none" x="869.2536556074002" y="388.162127031" width="161.1830162520703" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="870.3845542974002" y="394.947519171" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1326.139848260738 397.963249011 L 579.7578564601326 397.963249011" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,397.963249011) translate(-573.5504792061326,-397.963249011)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 579.8332497061326 394.82186376100003 L 573.5504792061326 397.963249011 L 579.8332497061326 401.104634261 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 478.30699397999985 409.27223591100005 L 662.0085722922655 409.27223591100005 L 668.7939644322655 416.05762805100005 L 668.7939644322655 434.15200709100003 L 478.30699397999985 434.15200709100003 L 478.30699397999985 409.27223591100005 M 662.0085722922655 409.27223591100005 L 662.0085722922655 416.05762805100005 L 668.7939644322655 416.05762805100005" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="488.86204841999984" y="419.827290351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="488.86204841999984" y="427.366614951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="582.4720133161327" y="445.46099399100007" width="61.085756730585935" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="582.4720133161327" y="453.00031859100005" width="253.09971852257812" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="583.6029120061327" y="452.24638613100007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="583.6029120061327" y="459.78571073100005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Bob's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 462.80144057100006 L 838.2858886947108 462.80144057100006" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(844.4932659487108,462.80144057100006) translate(-844.4932659487108,-462.80144057100006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 838.2104954487108 459.6600553210001 L 844.4932659487108 462.80144057100006 L 838.2104954487108 465.94282582100004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="952.3850907877712" y="474.1104274710001" width="62.94157643273437" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="952.3850907877712" y="481.6497520710001" width="265.86293263390627" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="953.5159894777712" y="480.8958196110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="953.5159894777712" y="488.4351442110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=realm-management, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 844.4932659487108 491.4508740510001 L 1319.932471006738 491.4508740510001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1326.139848260738,491.4508740510001) translate(-1326.139848260738,-491.4508740510001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1319.857077760738 488.3094888010001 L 1326.139848260738 491.4508740510001 L 1319.857077760738 494.59225930100007 Z"/></g></g><g><g><rect fill="white" stroke="none" x="998.431187589529" y="502.7598609510001" width="173.77073903039062" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="999.562086279529" y="509.5452530910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1326.139848260738 512.5609829310001 L 850.7006432027108 512.5609829310001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(844.4932659487108,512.5609829310001) translate(-844.4932659487108,-512.5609829310001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 850.7760364487108 509.41959768100014 L 844.4932659487108 512.5609829310001 L 850.7760364487108 515.7023681810001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="978.1894273356228" y="523.869969831" width="99.59637684777344" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="978.1894273356228" y="531.409294431" width="214.25425953820312" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="979.3203260256228" y="530.655361971" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Bob's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="979.3203260256228" y="538.194686571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Bob's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 844.4932659487108 541.2104164110001 L 1319.932471006738 541.2104164110001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1326.139848260738,541.2104164110001) translate(-1326.139848260738,-541.2104164110001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1319.857077760738 538.0690311610001 L 1326.139848260738 541.2104164110001 L 1319.857077760738 544.3518016610001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1042.6702241495875" y="552.5194033110001" width="85.29266591027344" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.8011228395876" y="559.3047954510001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Bob's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1326.139848260738 562.3205252910001 L 850.7006432027108 562.3205252910001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(844.4932659487108,562.3205252910001) translate(-844.4932659487108,-562.3205252910001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 850.7760364487108 559.1791400410001 L 844.4932659487108 562.3205252910001 L 850.7760364487108 565.4619105410001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="853.4148000587109" y="593.985688611" width="214.4750542159375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="853.4148000587109" y="601.525013211" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="854.5456987487108" y="600.771080751" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Send plain_message from challenge@bar.com to bob@outlook.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="854.5456987487108" y="608.310405351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 844.4932659487108 611.326135191 L 1070.6040111306484 611.326135191" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1076.8113883846484,611.326135191) translate(-1076.8113883846484,-611.326135191)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1070.5286178846484 608.1847499410001 L 1076.8113883846484 611.326135191 L 1070.5286178846484 614.467520441 Z"/></g></g><g><g><rect fill="white" stroke="none" x="900.1522896520702" y="622.635122091" width="259.8432182784375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="900.1522896520702" y="630.174446691" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="901.2831883420702" y="629.420514231" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Retrieve dkim_signed_message sent from bob@outlook.com to response@bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="901.2831883420702" y="636.959838831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1215.654531633867 639.975568671 L 850.7006432027108 639.975568671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(844.4932659487108,639.975568671) translate(-844.4932659487108,-639.975568671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 850.7760364487108 636.834183421 L 844.4932659487108 639.975568671 L 850.7760364487108 643.116953921 Z"/></g></g><g><g><rect fill="white" stroke="none" x="602.8242777204296" y="662.593542471" width="74.03749318078125" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="602.8242777204296" y="670.132867071" width="161.50802845910155" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="602.8242777204296" y="677.672191671" width="212.39518971398437" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="603.9551764104295" y="669.378934611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="603.9551764104295" y="676.918259211" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Bob's user_claims, dkim_signed_message - optional)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="603.9551764104295" y="684.457583811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 844.4932659487108 687.473313651 L 579.7578564601326 687.473313651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,687.473313651) translate(-573.5504792061326,-687.473313651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 579.8332497061326 684.331928401 L 573.5504792061326 687.473313651 L 579.8332497061326 690.614698901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="342.05540947642567" y="698.7823005509999" width="70.35185475304688" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="342.05540947642567" y="706.3216251509999" width="113.06170887902344" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="343.18630816642565" y="705.5676926909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="343.18630816642565" y="713.1070172909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 716.122747131 L 229.82942587974213 716.122747131" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(223.62204862574214,716.122747131) translate(-223.62204862574214,-716.122747131)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 229.90481912574214 712.981361881 L 223.62204862574214 716.122747131 L 229.90481912574214 719.264132381 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.51924180537105 727.431734031 L 343.9394633061132 727.431734031 L 350.7248554461132 734.217126171 L 350.7248554461132 759.850829811 L 96.51924180537105 759.850829811 L 96.51924180537105 727.431734031 M 343.9394633061132 727.431734031 L 343.9394633061132 734.217126171 L 350.7248554461132 734.217126171" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="107.07429624537104" y="737.9867884710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="107.07429624537104" y="745.526113071" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="107.07429624537104" y="753.065437671" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 85.49974107294918 811.872169551 L 354.9589640385351 811.872169551 L 361.7443561785351 818.657561691 L 361.7443561785351 889.527212931 L 85.49974107294918 889.527212931 L 85.49974107294918 811.872169551 M 354.9589640385351 811.872169551 L 354.9589640385351 818.657561691 L 361.7443561785351 818.657561691" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="822.427223991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="829.966548591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="837.505873191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="845.045197791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="852.584522391" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="860.1238469909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="867.6631715909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="875.2024961909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="96.05479551294917" y="882.7418207909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 74.87668656855465 921.1923762509999 L 365.58201854292963 921.1923762509999 L 372.36741068292963 927.9777683909999 L 372.36741068292963 998.847419631 L 74.87668656855465 998.847419631 L 74.87668656855465 921.1923762509999 M 365.58201854292963 921.1923762509999 L 365.58201854292963 927.9777683909999 L 372.36741068292963 927.9777683909999" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="931.747430691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract dkim_signed _message from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="939.286755291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. verify DKIM signature of dkim_signed _message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="946.826079891" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. extract 'From:' part of dkim_signed_message e.g. Bob Sanders &lt;bob@outlook.com&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="954.3654044909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. extract claims_provider_configuration_url and ticket_challenge from dkim_signed_message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="961.9047290909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. verify claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="969.4440536909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="976.9833782909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="984.5227028909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.43174100855464" y="992.0620274909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="374.33399681773426" y="1032.774380331" width="48.50453419640625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="375.46489550773424" y="1039.559772471" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 223.62204862574214 1042.575502311 L 567.3431019521327 1042.575502311" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,1042.575502311) translate(-573.5504792061326,-1042.575502311)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 567.2677087061327 1039.434117061 L 573.5504792061326 1042.575502311 L 567.2677087061327 1045.716887561 Z"/></g></g><g><g><rect fill="white" stroke="none" x="415.3397264185936" y="1053.884489211" width="134.086748551875" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="415.3397264185936" y="1061.4238138110002" width="20.00746388390625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="416.4706251085936" y="1060.6698813510002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Get data from Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="416.4706251085936" y="1068.2092059510003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 573.5504792061326 1071.224935791 L 397.4230994369296 1071.224935791" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(391.2157221829296,1071.224935791) translate(-391.2157221829296,-1071.224935791)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 397.4984926829296 1068.083550541 L 391.2157221829296 1071.224935791 L 397.4984926829296 1074.366321041 Z"/></g></g><g><g><rect fill="white" stroke="none" x="464.4149446192772" y="1082.533922691" width="35.93631215050781" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="465.5458433092772" y="1089.3193148310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 391.2157221829296 1092.335044671 L 567.3431019521327 1092.335044671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(573.5504792061326,1092.335044671) translate(-573.5504792061326,-1092.335044671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 567.2677087061327 1089.1936594210001 L 573.5504792061326 1092.335044671 L 567.2677087061327 1095.476429921 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1333.6791728607382 82.065548271 L 1580.489723894449 82.065548271 L 1580.489723894449 146.149807371 L 1333.6791728607382 146.149807371 L 1333.6791728607382 82.065548271 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1333.6791728607382 82.065548271 L 1333.6791728607382 91.112737791 L 1357.0414066554647 91.112737791 L 1361.5650014154646 86.58914303099999 L 1361.5650014154646 82.065548271 L 1333.6791728607382 82.065548271" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1341.2184974607383" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1369.1043260154647" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 818.1056298487108 573.6295121910001 L 1242.042167733867 573.6295121910001 L 1242.042167733867 651.284555571 L 818.1056298487108 651.284555571 L 818.1056298487108 573.6295121910001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 818.1056298487108 573.6295121910001 L 818.1056298487108 582.6767017110001 L 841.4678636434373 582.6767017110001 L 845.9914584034374 578.1531069510002 L 845.9914584034374 573.6295121910001 L 818.1056298487108 573.6295121910001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="825.6449544487108" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="853.5307830034374" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 63.56769966855467 771.1598167110001 L 383.6763975829296 771.1598167110001 L 383.6763975829296 1021.465393431 L 63.56769966855467 1021.465393431 L 63.56769966855467 771.1598167110001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 63.56769966855467 771.1598167110001 L 63.56769966855467 780.207006231 L 134.89358702773436 780.207006231 L 139.41718178773436 775.6834114710001 L 139.41718178773436 771.1598167110001 L 63.56769966855467 771.1598167110001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="71.10702426855467" y="777.1912763910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.10702426855465 791.5159931310001 L 376.1370729829296 791.5159931310001 L 376.1370729829296 1010.156406531 L 71.10702426855465 1010.156406531 L 71.10702426855465 791.5159931310001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 71.10702426855465 791.5159931310001 L 71.10702426855465 800.563182651 L 92.40356897636715 800.563182651 L 96.92716373636715 796.0395878910001 L 96.92716373636715 791.5159931310001 L 71.10702426855465 791.5159931310001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="78.64634886855465" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="104.46648833636715" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Domain part of email_address or WebFinger is used to locate Claims Provider configuration url]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 71.10702426855465 900.836199831 L 376.1370729829296 900.836199831" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray="1.8848311500000001"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="104.46648833636715" y="906.867659511" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g/></g></g></svg>