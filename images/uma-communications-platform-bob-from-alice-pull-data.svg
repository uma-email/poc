<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1585" height="1168"><desc>Title%20UMA%20communications%20platform%20-%20Bob%20from%20Alice%20(pull%20data)%0A%0Aactor%20%22Alice%20(RO)%5Cnalice%40gmail.com%2C%20alice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22UMA%20Server%5Cnfoo.com%22%20as%20asServer%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnfoo.com%22%20as%20rsServer%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnbar.com%22%20as%20rqpClient%20%23lightsteelblue%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnbar.com%22%20as%20claimsProvider%20%23lightsteelblue%0Aparticipant%20%22SMTP%20Server%5Cnoutlook.com%22%20as%20smtpServer%20%2300a2ed%0Aparticipant%20%22IMAP%20Server%5Cnoutlook.com%22%20as%20imapServer%20%2300a2ed%0Aparticipant%20%22IAM%20Server%5Cnbar.com%22%20as%20authServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RqP)%5Cnbob%40outlook.com%2C%20bob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Aopt%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0Anote%20over%20Bob%3AIf%20Bob%20uses%20an%20email%20provider%20(outlook)%20that%20does%20not%20support%5Cnthe%20WebFinger%20protocol%2C%20he%20must%20set%20up%20his%20email%20address%20to%20automatically%5Cnforward%20emails%20sent%20from%20challenge%40bar.com%20to%20response%40bar.com%0Aend%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Fbar.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Bob's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%5Cn%E2%80%A2%20can%20send%20email%20messages%20from%20address%20challenge%40bar.com%20and%20retrieve%20from%20response%40bar.com%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20bar.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20foo.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20bar.com%20IAM%20Server%0Anote%20over%20rsServer%3Afoo.com%20admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%5Cn'Outgoing'%20at%20the%20foo.com%20UMA%20Server%20with%20the%20associated%20scopes%20'query'%2C%20'view'%0ArqpClient%3C-Bob%3AInitiate%20request%0ArsServer%3C-rqpClient%3A1.%20Request%20Alice's%20'Outgoing'%20resource%5Cn(scope%3Dquery%2C%20view)%0ArsServer-%3ErqpClient%3A2.%20401%20with%20permission%20ticket%0ArqpClient-%3EauthServer%3A3.%20b)%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0ArqpClient%3C-authServer%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Bob's%20email_address%2C%20ticket_challenge)%0AclaimsProvider-%3EauthServer%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Drealm-management%2C%20role%3Dquery-users%2C%20view-users)%0AclaimsProvider%3C-authServer%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Bob's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Bob's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Bob's%20user_claims%0A%0Aopt%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0AsmtpServer%3C-claimsProvider%3A10.%20Send%20plain_message%20from%20challenge%40bar.com%20to%20bob%40outlook.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0AimapServer-%3EclaimsProvider%3A11.%20Retrieve%20dkim_signed_message%20sent%20from%20bob%40outlook.com%20to%20response%40bar.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0Aend%0ArqpClient%3C-claimsProvider%3A12.%20Return%20claims_token%5Cn(Bob's%20user_claims%2C%20dkim_signed_message%20-%20optional)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Aalt%20Domain%20part%20of%20email_address%20or%20WebFinger%20is%20used%20to%20locate%20Claims%20Provider%20configuration%20url%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aelse%20Bob%20has%20to%20demonstrate%20control%20of%20his%20email%20address%0Anote%20over%20asServer%3A1.%20extract%20dkim_signed%20_message%20from%20claims_token%5Cn2.%20verify%20DKIM%20signature%20of%20dkim_signed%20_message%5Cn3.%20extract%20'From%3A'%20part%20of%20dkim_signed_message%20e.g.%20Bob%20Sanders%20%3Cbob%40outlook.com%3E%5Cn4.%20extract%20claims_provider_configuration_url%20and%20ticket_challenge%20from%20dkim_signed_message%5Cn5.%20verify%20claims_token%20signature%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20extract%20user_claims%20from%20claims_token%5Cn8.%20evaluate%20user_claims%5Cn9.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArsServer%3C-rqpClient%3A15.%20Get%20data%20from%20Alice's%20'Outgoing'%20resource%5Cn(RPT)%0ArsServer-%3ErqpClient%3A16.%20200%20OK</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1585" height="1168"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.8801210184647" y="11.3089869" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA communications platform - Bob from Alice (pull data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 53.06913892353516 66.98689907100001 L 53.06913892353516 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 220.6628124807226 66.98689907100001 L 220.6628124807226 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.25648603791007 66.98689907100001 L 388.25648603791007 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 66.98689907100001 L 570.5912430611131 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 841.5340298036913 66.98689907100001 L 841.5340298036913 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1073.8521522396288 66.98689907100001 L 1073.8521522396288 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1212.6952954888475 66.98689907100001 L 1212.6952954888475 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1323.1806121157185 66.98689907100001 L 1323.1806121157185 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1454.125212232574 66.98689907100001 L 1454.125212232574 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 57.36655394553516 27.556231413000003 A 4.297415022 4.297415022 0 1 1 57.36655179682782 27.551933998694235 M 53.06913892353516 31.853646435 L 53.06913892353516 41.051622447 M 47.64082521153516 35.170949259000004 L 58.497452635535154 35.170949259000004 M 53.06913892353516 41.051622447 L 47.64082521153516 49.646452491000005 M 53.06913892353516 41.051622447 L 58.497452635535154 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="37.72206250751953" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3.7696623000000002" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com, alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 194.3599646256601 39.16679129700001 L 246.9656603357851 39.16679129700001 L 246.9656603357851 66.98689907100001 L 194.3599646256601 66.98689907100001 L 194.3599646256601 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="202.5401318166601" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="208.82424283960933" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 347.34108935472256 39.16679129700001 L 429.1718827210976 39.16679129700001 L 429.1718827210976 66.98689907100001 L 347.34108935472256 66.98689907100001 L 347.34108935472256 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.52125654572257" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.4179163967968" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 546.5033533969686 39.16679129700001 L 594.6791327252577 39.16679129700001 L 594.6791327252577 66.98689907100001 L 546.5033533969686 66.98689907100001 L 546.5033533969686 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.6835205879686" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7527802315233" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 802.1023138456014 39.16679129700001 L 880.9657457617811 39.16679129700001 L 880.9657457617811 66.98689907100001 L 802.1023138456014 66.98689907100001 L 802.1023138456014 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="810.2824810366014" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="829.6955669741014" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1045.6999849265585 39.16679129700001 L 1102.0043195526991 39.16679129700001 L 1102.0043195526991 66.98689907100001 L 1045.6999849265585 66.98689907100001 L 1045.6999849265585 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1053.8801521175585" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1055.9082282894335" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1185.6514198017537 39.16679129700001 L 1239.7391711759412 39.16679129700001 L 1239.7391711759412 66.98689907100001 L 1185.6514198017537 66.98689907100001 L 1185.6514198017537 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1193.8315869927537" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1194.7513715386522" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1298.3565698026482 39.16679129700001 L 1348.0046544287889 39.16679129700001 L 1348.0046544287889 66.98689907100001 L 1298.3565698026482 66.98689907100001 L 1298.3565698026482 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1306.5367369936482" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1311.3421492861287" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1458.422627254574 27.556231413000003 A 4.297415022 4.297415022 0 1 1 1458.4226251058667 27.551933998694235 M 1454.125212232574 31.853646435 L 1454.125212232574 41.051622447 M 1448.696898520574 35.170949259000004 L 1459.5535259445742 35.170949259000004 M 1454.125212232574 41.051622447 L 1448.696898520574 49.646452491000005 M 1454.125212232574 41.051622447 L 1459.5535259445742 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1438.5880036754452" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.6308350963436" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com, bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 57.36655394553516 1141.001384964 A 4.297415022 4.297415022 0 1 1 57.36655179682782 1140.9970875496942 M 53.06913892353516 1145.298799986 L 53.06913892353516 1154.496775998 M 47.64082521153516 1148.61610281 L 58.497452635535154 1148.61610281 M 53.06913892353516 1154.496775998 L 47.64082521153516 1163.091606042 M 53.06913892353516 1154.496775998 L 58.497452635535154 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="37.72206250751953" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3.7696623000000002" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com, alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 194.3599646256601 1118.7226807710001 L 246.9656603357851 1118.7226807710001 L 246.9656603357851 1146.5427885450001 L 194.3599646256601 1146.5427885450001 L 194.3599646256601 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="202.5401318166601" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="208.82424283960933" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 347.34108935472256 1118.7226807710001 L 429.1718827210976 1118.7226807710001 L 429.1718827210976 1146.5427885450001 L 347.34108935472256 1146.5427885450001 L 347.34108935472256 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.52125654572257" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.4179163967968" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 546.5033533969686 1118.7226807710001 L 594.6791327252577 1118.7226807710001 L 594.6791327252577 1146.5427885450001 L 546.5033533969686 1146.5427885450001 L 546.5033533969686 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.6835205879686" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.7527802315233" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 802.1023138456014 1118.7226807710001 L 880.9657457617811 1118.7226807710001 L 880.9657457617811 1146.5427885450001 L 802.1023138456014 1146.5427885450001 L 802.1023138456014 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="810.2824810366014" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="829.6955669741014" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1045.6999849265585 1118.7226807710001 L 1102.0043195526991 1118.7226807710001 L 1102.0043195526991 1146.5427885450001 L 1045.6999849265585 1146.5427885450001 L 1045.6999849265585 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1053.8801521175585" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1055.9082282894335" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="#00a2ed" stroke="black" paint-order="fill stroke markers" d=" M 1185.6514198017537 1118.7226807710001 L 1239.7391711759412 1118.7226807710001 L 1239.7391711759412 1146.5427885450001 L 1185.6514198017537 1146.5427885450001 L 1185.6514198017537 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1193.8315869927537" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1194.7513715386522" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">outlook.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1298.3565698026482 1118.7226807710001 L 1348.0046544287889 1118.7226807710001 L 1348.0046544287889 1146.5427885450001 L 1298.3565698026482 1146.5427885450001 L 1298.3565698026482 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1306.5367369936482" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1311.3421492861287" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1458.422627254574 1141.001384964 A 4.297415022 4.297415022 0 1 1 1458.4226251058667 1140.9970875496942 M 1454.125212232574 1145.298799986 L 1454.125212232574 1154.496775998 M 1448.696898520574 1148.61610281 L 1459.5535259445742 1148.61610281 M 1454.125212232574 1154.496775998 L 1448.696898520574 1163.091606042 M 1454.125212232574 1154.496775998 L 1459.5535259445742 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1438.5880036754452" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.6308350963436" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com, bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1334.4895990157186 102.421724691 L 1566.9754333094293 102.421724691 L 1573.7608254494294 109.207116831 L 1573.7608254494294 134.840820471 L 1334.4895990157186 134.840820471 L 1334.4895990157186 102.421724691 M 1566.9754333094293 102.421724691 L 1566.9754333094293 109.207116831 L 1573.7608254494294 109.207116831" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1345.0446534557186" y="112.97677913099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Bob uses an email provider (outlook) that does not support</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1345.0446534557186" y="120.51610373099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the WebFinger protocol, he must set up his email address to automatically</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1345.0446534557186" y="128.05542833099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">forward emails sent from challenge@bar.com to response@bar.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 620.9398823461132 157.458794271 L 1055.3427851212693 157.458794271 L 1062.1281772612695 164.244186411 L 1062.1281772612695 197.417214651 L 620.9398823461132 197.417214651 L 620.9398823461132 157.458794271 M 1055.3427851212693 157.458794271 L 1055.3427851212693 164.244186411 L 1062.1281772612695 164.244186411" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="631.4949367861132" y="168.01384871099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="631.4949367861132" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="750.0041378359178" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="753.7027767519335" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="631.4949367861132" y="183.09249791099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Bob's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="631.4949367861132" y="190.63182251099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• can send email messages from address challenge@bar.com and retrieve from response@bar.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 392.02614833791 208.72620155099997 L 742.3709456443163 208.72620155099997 L 749.1563377843163 215.51159369099997 L 749.1563377843163 241.145297331 L 392.02614833791 241.145297331 L 392.02614833791 208.72620155099997 M 742.3709456443163 208.72620155099997 L 742.3709456443163 215.51159369099997 L 749.1563377843163 215.51159369099997" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="402.58120277791" y="219.28125599100002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="402.58120277791" y="226.820580591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at bar.com IAM Server and pre-registered as a universal AEMS public client at foo.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="402.58120277791" y="234.359905191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at bar.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 260.862793292246 252.454284231 L 508.8647866435741 252.454284231 L 515.6501787835741 259.23967637100003 L 515.6501787835741 277.334055411 L 260.862793292246 277.334055411 L 260.862793292246 252.454284231 M 508.8647866435741 252.454284231 L 508.8647866435741 259.23967637100003 L 515.6501787835741 259.23967637100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="271.417847732246" y="263.00933867099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com admin has set up the Resource Server and registers it's resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="271.417847732246" y="270.54866327099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Outgoing' at the foo.com UMA Server with the associated scopes 'query', 'view'</text></g><g><g><rect fill="white" stroke="none" x="989.3962590105546" y="288.643042311" width="45.92393727257812" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="990.5271577005545" y="295.428434451" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1454.125212232574 298.444164291 L 576.7986203151131 298.444164291" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,298.444164291) translate(-570.5912430611131,-298.444164291)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 576.8740135611131 295.302779041 L 570.5912430611131 298.444164291 L 576.8740135611131 301.585549541 Z"/></g></g><g><g><rect fill="white" stroke="none" x="422.1828584376366" y="309.75315119100003" width="114.48201222375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="422.1828584376366" y="317.292475791" width="61.514482926875" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="423.31375712763656" y="316.538543331" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="423.31375712763656" y="324.077867931" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=query, view)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 327.093597771 L 394.46386329191006 327.093597771" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(388.25648603791007,327.093597771) translate(-388.25648603791007,-327.093597771)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 394.5392565379101 323.95221252100004 L 388.25648603791007 327.093597771 L 394.5392565379101 330.234983021 Z"/></g></g><g><g><rect fill="white" stroke="none" x="436.48827073011705" y="338.402584671" width="85.87118763878907" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="437.61916942011703" y="345.187976811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.25648603791007 348.203706651 L 564.3838658071131 348.203706651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,348.203706651) translate(-570.5912430611131,-348.203706651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 564.3084725611131 345.062321401 L 570.5912430611131 348.203706651 L 564.3084725611131 351.345091901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="864.9163677045682" y="359.51269355100004" width="70.70936818078125" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="864.9163677045682" y="367.052018151" width="163.9391197676953" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="866.0472663945682" y="366.29808569100004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. b) Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="866.0472663945682" y="373.837410291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 376.85314013100003 L 1316.9732348617185 376.85314013100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1323.1806121157185,376.85314013100003) translate(-1323.1806121157185,-376.85314013100003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1316.8978416157186 373.71175488100005 L 1323.1806121157185 376.85314013100003 L 1316.8978416157186 379.994525381 Z"/></g></g><g><g><rect fill="white" stroke="none" x="866.2944194623807" y="388.162127031" width="161.1830162520703" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="867.4253181523807" y="394.947519171" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1323.1806121157185 397.963249011 L 576.7986203151131 397.963249011" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,397.963249011) translate(-570.5912430611131,-397.963249011)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 576.8740135611131 394.82186376100003 L 570.5912430611131 397.963249011 L 576.8740135611131 401.104634261 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 475.3477578349803 409.27223591100005 L 659.049336147246 409.27223591100005 L 665.834728287246 416.05762805100005 L 665.834728287246 434.15200709100003 L 475.3477578349803 434.15200709100003 L 475.3477578349803 409.27223591100005 M 659.049336147246 409.27223591100005 L 659.049336147246 416.05762805100005 L 665.834728287246 416.05762805100005" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.9028122749803" y="419.827290351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.9028122749803" y="427.366614951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="579.5127771711132" y="445.46099399100007" width="61.085756730585935" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="579.5127771711132" y="453.00031859100005" width="253.09971852257812" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="580.6436758611131" y="452.24638613100007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="580.6436758611131" y="459.78571073100005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Bob's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 462.80144057100006 L 835.3266525496913 462.80144057100006" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(841.5340298036913,462.80144057100006) translate(-841.5340298036913,-462.80144057100006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 835.2512593036913 459.6600553210001 L 841.5340298036913 462.80144057100006 L 835.2512593036913 465.94282582100004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="949.4258546427517" y="474.1104274710001" width="62.94157643273437" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="949.4258546427517" y="481.6497520710001" width="265.86293263390627" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="950.5567533327517" y="480.8958196110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="950.5567533327517" y="488.4351442110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=realm-management, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 841.5340298036913 491.4508740510001 L 1316.9732348617185 491.4508740510001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1323.1806121157185,491.4508740510001) translate(-1323.1806121157185,-491.4508740510001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1316.8978416157186 488.3094888010001 L 1323.1806121157185 491.4508740510001 L 1316.8978416157186 494.59225930100007 Z"/></g></g><g><g><rect fill="white" stroke="none" x="995.4719514445095" y="502.7598609510001" width="173.77073903039062" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.6028501345095" y="509.5452530910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1323.1806121157185 512.5609829310001 L 847.7414070576913 512.5609829310001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(841.5340298036913,512.5609829310001) translate(-841.5340298036913,-512.5609829310001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 847.8168003036913 509.41959768100014 L 841.5340298036913 512.5609829310001 L 847.8168003036913 515.7023681810001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="975.2301911906033" y="523.869969831" width="99.59637684777344" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="975.2301911906033" y="531.409294431" width="214.25425953820312" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.3610898806032" y="530.655361971" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Bob's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="976.3610898806032" y="538.194686571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Bob's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 841.5340298036913 541.2104164110001 L 1316.9732348617185 541.2104164110001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1323.1806121157185,541.2104164110001) translate(-1323.1806121157185,-541.2104164110001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1316.8978416157186 538.0690311610001 L 1323.1806121157185 541.2104164110001 L 1316.8978416157186 544.3518016610001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1039.710988004568" y="552.5194033110001" width="85.29266591027344" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1040.841886694568" y="559.3047954510001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Bob's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1323.1806121157185 562.3205252910001 L 847.7414070576913 562.3205252910001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(841.5340298036913,562.3205252910001) translate(-841.5340298036913,-562.3205252910001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 847.8168003036913 559.1791400410001 L 841.5340298036913 562.3205252910001 L 847.8168003036913 565.4619105410001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="850.4555639136913" y="593.985688611" width="214.4750542159375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="850.4555639136913" y="601.525013211" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.5864626036913" y="600.771080751" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Send plain_message from challenge@bar.com to bob@outlook.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.5864626036913" y="608.310405351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 841.5340298036913 611.326135191 L 1067.6447749856288 611.326135191" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1073.8521522396288,611.326135191) translate(-1073.8521522396288,-611.326135191)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1067.5693817396289 608.1847499410001 L 1073.8521522396288 611.326135191 L 1067.5693817396289 614.467520441 Z"/></g></g><g><g><rect fill="white" stroke="none" x="897.1930535070506" y="622.635122091" width="259.8432182784375" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="897.1930535070506" y="630.174446691" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="898.3239521970506" y="629.420514231" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Retrieve dkim_signed_message sent from bob@outlook.com to response@bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="898.3239521970506" y="636.959838831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1212.6952954888475 639.975568671 L 847.7414070576913 639.975568671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(841.5340298036913,639.975568671) translate(-841.5340298036913,-639.975568671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 847.8168003036913 636.834183421 L 841.5340298036913 639.975568671 L 847.8168003036913 643.116953921 Z"/></g></g><g><g><rect fill="white" stroke="none" x="599.86504157541" y="662.593542471" width="74.03749318078125" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="599.86504157541" y="670.132867071" width="161.50802845910155" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="599.86504157541" y="677.672191671" width="212.39518971398437" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="600.99594026541" y="669.378934611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="600.99594026541" y="676.918259211" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Bob's user_claims, dkim_signed_message - optional)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="600.99594026541" y="684.457583811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 841.5340298036913 687.473313651 L 576.7986203151131 687.473313651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,687.473313651) translate(-570.5912430611131,-687.473313651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 576.8740135611131 684.331928401 L 570.5912430611131 687.473313651 L 576.8740135611131 690.614698901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="339.09617333140613" y="698.7823005509999" width="70.35185475304688" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="339.09617333140613" y="706.3216251509999" width="113.06170887902344" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.2270720214061" y="705.5676926909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.2270720214061" y="713.1070172909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 716.122747131 L 226.8701897347226 716.122747131" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(220.6628124807226,716.122747131) translate(-220.6628124807226,-716.122747131)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 226.9455829807226 712.981361881 L 220.6628124807226 716.122747131 L 226.9455829807226 719.264132381 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 93.56000566035152 727.431734031 L 340.9802271610937 727.431734031 L 347.7656193010937 734.217126171 L 347.7656193010937 759.850829811 L 93.56000566035152 759.850829811 L 93.56000566035152 727.431734031 M 340.9802271610937 727.431734031 L 340.9802271610937 734.217126171 L 347.7656193010937 734.217126171" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="104.11506010035151" y="737.9867884710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="104.11506010035151" y="745.526113071" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="104.11506010035151" y="753.065437671" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 82.54050492792965 811.872169551 L 351.99972789351557 811.872169551 L 358.78512003351557 818.657561691 L 358.78512003351557 889.527212931 L 82.54050492792965 889.527212931 L 82.54050492792965 811.872169551 M 351.99972789351557 811.872169551 L 351.99972789351557 818.657561691 L 358.78512003351557 818.657561691" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="822.427223991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="829.966548591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="837.505873191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="845.045197791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="852.584522391" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="860.1238469909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="867.6631715909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="875.2024961909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="93.09555936792964" y="882.7418207909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 71.91745042353512 921.1923762509999 L 362.6227823979101 921.1923762509999 L 369.4081745379101 927.9777683909999 L 369.4081745379101 998.847419631 L 71.91745042353512 998.847419631 L 71.91745042353512 921.1923762509999 M 362.6227823979101 921.1923762509999 L 362.6227823979101 927.9777683909999 L 369.4081745379101 927.9777683909999" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="931.747430691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract dkim_signed _message from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="939.286755291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. verify DKIM signature of dkim_signed _message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="946.826079891" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. extract 'From:' part of dkim_signed_message e.g. Bob Sanders &lt;bob@outlook.com&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="954.3654044909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. extract claims_provider_configuration_url and ticket_challenge from dkim_signed_message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="961.9047290909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. verify claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="969.4440536909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="976.9833782909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="984.5227028909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.47250486353511" y="992.0620274909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="371.37476067271473" y="1032.774380331" width="48.50453419640625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="372.5056593627147" y="1039.559772471" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 220.6628124807226 1042.575502311 L 564.3838658071131 1042.575502311" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,1042.575502311) translate(-570.5912430611131,-1042.575502311)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 564.3084725611131 1039.434117061 L 570.5912430611131 1042.575502311 L 564.3084725611131 1045.716887561 Z"/></g></g><g><g><rect fill="white" stroke="none" x="412.3804902735741" y="1053.884489211" width="134.086748551875" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="412.3804902735741" y="1061.4238138110002" width="20.00746388390625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="413.51138896357406" y="1060.6698813510002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Get data from Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="413.51138896357406" y="1068.2092059510003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 570.5912430611131 1071.224935791 L 394.46386329191006 1071.224935791" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(388.25648603791007,1071.224935791) translate(-388.25648603791007,-1071.224935791)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 394.5392565379101 1068.083550541 L 388.25648603791007 1071.224935791 L 394.5392565379101 1074.366321041 Z"/></g></g><g><g><rect fill="white" stroke="none" x="461.4557084742577" y="1082.533922691" width="35.93631215050781" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="462.58660716425766" y="1089.3193148310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.25648603791007 1092.335044671 L 564.3838658071131 1092.335044671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(570.5912430611131,1092.335044671) translate(-570.5912430611131,-1092.335044671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 564.3084725611131 1089.1936594210001 L 570.5912430611131 1092.335044671 L 564.3084725611131 1095.476429921 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1330.7199367157186 82.065548271 L 1577.5304877494295 82.065548271 L 1577.5304877494295 146.149807371 L 1330.7199367157186 146.149807371 L 1330.7199367157186 82.065548271 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1330.7199367157186 82.065548271 L 1330.7199367157186 91.112737791 L 1354.0821705104452 91.112737791 L 1358.605765270445 86.58914303099999 L 1358.605765270445 82.065548271 L 1330.7199367157186 82.065548271" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1338.2592613157187" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1366.1450898704452" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 815.1463937036913 573.6295121910001 L 1239.0829315888475 573.6295121910001 L 1239.0829315888475 651.284555571 L 815.1463937036913 651.284555571 L 815.1463937036913 573.6295121910001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 815.1463937036913 573.6295121910001 L 815.1463937036913 582.6767017110001 L 838.5086274984178 582.6767017110001 L 843.0322222584178 578.1531069510002 L 843.0322222584178 573.6295121910001 L 815.1463937036913 573.6295121910001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="822.6857183036913" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="850.5715468584178" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 60.608463523535136 771.1598167110001 L 380.7171614379101 771.1598167110001 L 380.7171614379101 1021.465393431 L 60.608463523535136 1021.465393431 L 60.608463523535136 771.1598167110001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 60.608463523535136 771.1598167110001 L 60.608463523535136 780.207006231 L 131.93435088271482 780.207006231 L 136.45794564271483 775.6834114710001 L 136.45794564271483 771.1598167110001 L 60.608463523535136 771.1598167110001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="68.14778812353514" y="777.1912763910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 68.14778812353512 791.5159931310001 L 373.1778368379101 791.5159931310001 L 373.1778368379101 1010.156406531 L 68.14778812353512 1010.156406531 L 68.14778812353512 791.5159931310001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 68.14778812353512 791.5159931310001 L 68.14778812353512 800.563182651 L 89.44433283134762 800.563182651 L 93.96792759134762 796.0395878910001 L 93.96792759134762 791.5159931310001 L 68.14778812353512 791.5159931310001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="75.68711272353512" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="101.50725219134762" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Domain part of email_address or WebFinger is used to locate Claims Provider configuration url]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 68.14778812353512 900.836199831 L 373.1778368379101 900.836199831" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray="1.8848311500000001"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="101.50725219134762" y="906.867659511" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Bob has to demonstrate control of his email address]</text></g><g/></g></g></svg>