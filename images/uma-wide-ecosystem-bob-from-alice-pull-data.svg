<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1497" height="1376"><desc>Title%20UMA%20wide%20ecosystem%20-%20Bob%20from%20Alice%20(pull%20data)%0A%0Aactor%20%22Alice%20(RO)%5Cnalice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22AuthZ%20Server%5Cnfoo.com%22%20as%20asServer%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnfoo.com%22%20as%20rsServer%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnbar.com%22%20as%20rqpClient%20%23lightsteelblue%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnbar.com%22%20as%20claimsProvider%20%23lightsteelblue%0Aparticipant%20%22AuthN%20Server%5Cnbar.com%22%20as%20authServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RqP)%5Cnbob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Anote%20over%20rqpClient%3ARqP%20Client%20is%20registered%20at%20Bob's%20AuthN%20server%0Anote%20over%20claimsProvider%3AClaims%20Provider%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Fbar.com%2F.well-known%2Fclaims-provider-configuration%0Anote%20right%20of%20claimsProvider%3AClaims%20Provider%20is%20registered%20at%20Bob's%20AuthN%20server%20and%20is%20assigned%20'query-users'%20admin%20role%0ArqpClient%3C-Bob%3AInitiate%20request%0ArsServer%3C-rqpClient%3A1.%20Request%20Alice's%20'Outgoing'%20resource%0ArsServer-%3ErqpClient%3A2.%20401%20with%20permission%20ticket%0Aalt%20RqP%20Client%20uses%20Authorization%20Code%20Grant%20-%20Bob%20is%20involved%0ArqpClient-%3EauthServer%3A3.%20a)%20Get%20access_token%5Cn(grant_type%3Dauthorization_code%2C%20scope%3Dclaims-provider)%0Aelse%20RqP%20Client%20uses%20Client%20Credential%20Grant%20-%20Bob%20is%20not%20involved%0ArqpClient-%3EauthServer%3A3.%20b)%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0Aend%0ArqpClient%3C-authServer%3A4.%20Return%20access_token%0Anote%20right%20of%20rqpClient%3ACreate%20ticket_digest%0Aalt%20Get%20Claims%20%20-%20Bob%20was%20involved%20at%20step%20%203.%20a)%0Anote%20right%20of%20rqpClient%3ABob's%20email_address%20is%20in%20access_token%20returned%20at%20step%203.%20a)%0AclaimsProvider%3C-rqpClient%3A5.%20a)%20Get%20claims_token%5Cn(access_token%2C%20ticket_digest)%0Aelse%20Get%20Claims%20-%20Bob%20was%20not%20involved%20at%20step%20%203.%20b)%0Anote%20right%20of%20rqpClient%3A%20The%20email_address%20is%20determined%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20b)%20Get%20claims_token%5Cn(access_token%2C%20Bob's%20email_address%2C%20ticket_digest)%0Aend%0Anote%20right%20of%20claimsProvider%3AClaims%20Provider%20is%20assigned%20the%20'query-users'%20admin%20role%2C%20thus%20can%20query%20any%20user%20to%20get%20their%20claims%0AclaimsProvider-%3EauthServer%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20role%3Dquery-users)%0AclaimsProvider%3C-authServer%3A7.%20Return%20access_token%0A%0Aalt%20Prepare%20email_address%20-%20Bob%20was%20involved%20at%20step%20%203.%20a)%0Anote%20right%20of%20claimsProvider%3AUse%20Bob's%20email_address%20extracted%20from%20access_token%20from%20a%20request%20at%20step%205.%20a)%0Aelse%20Prepare%20email_address%20-%20Bob%20was%20not%20involved%20at%20step%20%203.%20b)%0Anote%20right%20of%20claimsProvider%3AUse%20Bob's%20email_address%20extracted%20from%20a%20request%20body%20at%20step%205.%20b)%0Aend%0AauthServer%3C-claimsProvider%3A8.%20Query%20Bob's%20user_claims%5Cn(access_token%2C%20Bob's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Bob's%20user_claims%0A%0ArqpClient%3C-claimsProvider%3A10.%20Return%20claims_token%5Cn(Bob's%20user_claims%2C%20ticket_digest)%0ArqpClient-%3EasServer%3A11.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token%20%2B%20metadata)%0Agroup%20Authorization%20process%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn1.%20recipient_info%20(email%20address%2C%20fullname)%5Cn2.%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Anote%20over%20asServer%3AAuthZ%20Server%20uses%20domain%20part%20of%20Bob's%20email_address%20extracted%20from%20claims_token%5Cnto%20load%20Claims%20Provider%20configuration%20from%20URL%3A%5Cn'https%3A%2F%2F'%20%2B%20domain_part_of_email_address%20%2B%20'%2F.well-known%2Fclaims-provider-configuration'%0Anote%20over%20asServer%3AAuthZ%20Server%20evaluates%3A%5Cn1.%20domain%20part%20of%20email_address%20vs.%20claims%20issuer%5Cn2.%20ticket%5Cn3.%20ticket_digest%20vs.%20ticket%5Cn4.%20claims_token%20signature%5Cn5.%20user_claims%5Cn6.%20other_claims%20(recipient_info%2C%20file_info)%0Aend%0ArqpClient%3C-asServer%3A12.%20Return%20RPT%0ArsServer%3C-rqpClient%3A13.%20Get%20data%20from%20Alice's%20'Outgoing'%20resource%5Cn(RPT)%0ArsServer-%3ErqpClient%3A14.%20200%20OK</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1497" height="1376"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="10.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="596.8844427006843" y="13.19381805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA wide ecosystem - Bob from Alice (pull data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 35.31561055361328 78.15138224949999 L 35.31561055361328 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 241.18967898625002 78.15138224949999 L 241.18967898625002 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 447.06374741888675 78.15138224949999 L 447.06374741888675 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 78.15138224949999 L 655.2602991963607 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 78.15138224949999 L 942.9811470454233 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1389.0344533905795 78.15138224949999 L 1389.0344533905795 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.4767428653336 78.15138224949999 L 1464.4767428653336 1319.2498668194992" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 32.143922998476604 M 35.31561055361328 37.16258750749999 L 35.31561055361328 47.893559521499995 M 28.98257788961328 41.03277413549999 L 41.648643217613284 41.03277413549999 M 35.31561055361328 47.893559521499995 L 28.98257788961328 57.92086123949999 M 35.31561055361328 47.893559521499995 L 41.648643217613284 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="13.808065082421876" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 204.16960335553907 45.694589846499994 L 278.20975461696094 45.694589846499994 L 278.20975461696094 78.15138224949999 L 204.16960335553907 78.15138224949999 L 204.16960335553907 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="213.71313174503908" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="224.59898837345705" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 391.64475363632033 45.694589846499994 L 502.48274120145317 45.694589846499994 L 502.48274120145317 78.15138224949999 L 391.64475363632033 78.15138224949999 L 391.64475363632033 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.18828202582034" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="430.4730568060938" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 623.4235197692631 45.694589846499994 L 687.0970786234584 45.694589846499994 L 687.0970786234584 78.15138224949999 L 623.4235197692631 78.15138224949999 L 623.4235197692631 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="632.9670481587631" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.669669618724" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 889.6413921544585 45.694589846499994 L 996.3209019363882 45.694589846499994 L 996.3209019363882 78.15138224949999 L 889.6413921544585 78.15138224949999 L 889.6413921544585 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.1849205439585" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="926.3905174677866" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1351.4951364268609 45.694589846499994 L 1426.5737703542984 45.694589846499994 L 1426.5737703542984 78.15138224949999 L 1351.4951364268609 78.15138224949999 L 1351.4951364268609 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1361.0386648163608" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthN Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1372.4438238129428" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1469.4903937243337 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 1469.4903912175084 32.143922998476604 M 1464.4767428653336 37.16258750749999 L 1464.4767428653336 47.893559521499995 M 1458.1437102013335 41.03277413549999 L 1470.8097755293336 41.03277413549999 M 1464.4767428653336 47.893559521499995 L 1458.1437102013335 57.92086123949999 M 1464.4767428653336 47.893559521499995 L 1470.8097755293336 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1442.7027484195328" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1435.3696490542984" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 40.329261412613285 1345.2416883779993 A 5.013650858999999 5.013650858999999 0 1 1 40.32925890578806 1345.236674727976 M 35.31561055361328 1350.2553392369991 L 35.31561055361328 1360.986311250999 M 28.98257788961328 1354.1255258649992 L 41.648643217613284 1354.1255258649992 M 35.31561055361328 1360.986311250999 L 28.98257788961328 1371.013612968999 M 35.31561055361328 1360.986311250999 L 41.648643217613284 1371.013612968999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="13.808065082421876" y="1328.0457455194992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4.3979393500000015" y="1336.8416242194992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 204.16960335553907 1319.2498668194992 L 278.20975461696094 1319.2498668194992 L 278.20975461696094 1351.7066592224992 L 204.16960335553907 1351.7066592224992 L 204.16960335553907 1319.2498668194992 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="213.71313174503908" y="1334.1149018224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="224.59898837345705" y="1342.9107805224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 391.64475363632033 1319.2498668194992 L 502.48274120145317 1319.2498668194992 L 502.48274120145317 1351.7066592224992 L 391.64475363632033 1351.7066592224992 L 391.64475363632033 1319.2498668194992 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.18828202582034" y="1334.1149018224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="430.4730568060938" y="1342.9107805224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 623.4235197692631 1319.2498668194992 L 687.0970786234584 1319.2498668194992 L 687.0970786234584 1351.7066592224992 L 623.4235197692631 1351.7066592224992 L 623.4235197692631 1319.2498668194992 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="632.9670481587631" y="1334.1149018224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.669669618724" y="1342.9107805224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 889.6413921544585 1319.2498668194992 L 996.3209019363882 1319.2498668194992 L 996.3209019363882 1351.7066592224992 L 889.6413921544585 1351.7066592224992 L 889.6413921544585 1319.2498668194992 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.1849205439585" y="1334.1149018224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="926.3905174677866" y="1342.9107805224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1351.4951364268609 1319.2498668194992 L 1426.5737703542984 1319.2498668194992 L 1426.5737703542984 1351.7066592224992 L 1351.4951364268609 1351.7066592224992 L 1351.4951364268609 1319.2498668194992 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1361.0386648163608" y="1334.1149018224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthN Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1372.4438238129428" y="1342.9107805224992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1469.4903937243337 1345.2416883779993 A 5.013650858999999 5.013650858999999 0 1 1 1469.4903912175084 1345.236674727976 M 1464.4767428653336 1350.2553392369991 L 1464.4767428653336 1360.986311250999 M 1458.1437102013335 1354.1255258649992 L 1470.8097755293336 1354.1255258649992 M 1464.4767428653336 1360.986311250999 L 1458.1437102013335 1371.013612968999 M 1464.4767428653336 1360.986311250999 L 1470.8097755293336 1371.013612968999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1442.7027484195328" y="1328.0457455194992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1435.3696490542984" y="1336.8416242194992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 547.4374172829623 95.7431396495 L 755.1668902797592 95.7431396495 L 763.0831811097592 103.65943047949999 L 763.0831811097592 115.97366065949998 L 547.4374172829623 115.97366065949998 L 547.4374172829623 95.7431396495 M 755.1668902797592 95.7431396495 L 755.1668902797592 103.65943047949999 L 763.0831811097592 103.65943047949999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="559.7516474629623" y="108.0573698295" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client is registered at Bob's AuthN server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 710.3261575880796 129.1674787095 L 1167.7198456727672 129.1674787095 L 1175.6361365027672 137.0837695395 L 1175.6361365027672 149.39799971949998 L 710.3261575880796 149.39799971949998 L 710.3261575880796 129.1674787095 M 1167.7198456727672 129.1674787095 L 1167.7198456727672 137.0837695395 L 1175.6361365027672 137.0837695395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="722.6403877680796" y="141.48170888949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="951.284537548353" y="141.48170888949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="956.4678566401499" y="141.48170888949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com/.well-known/claims-provider-configuration</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 172.70707827449996 L 947.3790863954233 172.70707827449996 M 947.3790863954233 162.59181776949998 L 1345.3151939137047 162.59181776949998 L 1353.2314847437046 170.5081085995 L 1353.2314847437046 182.82233877949997 L 947.3790863954233 182.82233877949997 L 947.3790863954233 162.59181776949998 M 1345.3151939137047 162.59181776949998 L 1345.3151939137047 170.5081085995 L 1353.2314847437046 170.5081085995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="959.6933165754233" y="174.90604794949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider is registered at Bob's AuthN server and is assigned 'query-users' admin role</text></g><g><g><rect fill="white" stroke="none" x="1027.954839909441" y="196.01615682949998" width="63.8273622428125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1029.274221714441" y="203.93244765949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1464.4767428653336 207.45079913949996 L 662.5022393260274 207.45079913949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,207.45079913949996) translate(-655.2602991963607,-207.45079913949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 662.5901981130274 203.78584968116664 L 655.2602991963607 207.45079913949996 L 662.5901981130274 211.1157485978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="471.20934835076827" y="220.64461718949997" width="159.90534991371095" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="472.52873015576824" y="228.56090801949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Alice's 'Outgoing' resource</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 232.07925949949995 L 454.3056875485534 232.07925949949995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(447.06374741888675,232.07925949949995) translate(-447.06374741888675,-232.07925949949995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 454.3936463355534 228.41431004116663 L 447.06374741888675 232.07925949949995 L 454.3936463355534 235.74420895783328 Z"/></g></g><g><g><rect fill="white" stroke="none" x="491.25710073113936" y="245.27307754949996" width="119.80984515296875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="492.57648253613934" y="253.18936837949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 447.06374741888675 256.70771985949995 L 648.0183590666941 256.70771985949995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,256.70771985949995) translate(-655.2602991963607,-256.70771985949995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 647.930400279694 253.04277040116662 L 655.2602991963607 256.70771985949995 L 647.930400279694 260.3726693178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="904.1625281798764" y="293.6504103994999" width="98.56188983070312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="904.1625281798764" y="302.4462890994999" width="235.9696962271875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="905.4819099848764" y="301.56670122949987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. a) Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="905.4819099848764" y="310.3625799294999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=authorization_code, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 313.8809314094999 L 1381.7925132609128 313.8809314094999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1389.0344533905795,313.8809314094999) translate(-1389.0344533905795,-313.8809314094999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1381.7045544739128 310.21598195116655 L 1389.0344533905795 313.8809314094999 L 1381.7045544739128 317.54588086783326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="907.539878033392" y="350.8236219494999" width="98.56188983070312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="907.539878033392" y="359.6195006494999" width="229.21499652015626" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="908.8592598383921" y="358.7399127794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. b) Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="908.8592598383921" y="367.5357914794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 371.0541429594999 L 1381.7925132609128 371.0541429594999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1389.0344533905795,371.0541429594999) translate(-1389.0344533905795,-371.0541429594999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1381.7045544739128 367.3891935011666 L 1389.0344533905795 371.0541429594999 L 1381.7045544739128 374.7190924178333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="971.827948712103" y="397.44177905949994" width="100.63885516273437" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="973.147330517103" y="405.3580698894999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1389.0344533905795 408.87642136949995 L 662.5022393260274 408.87642136949995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,408.87642136949995) translate(-655.2602991963607,-408.87642136949995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 662.5901981130274 405.2114719111666 L 655.2602991963607 408.87642136949995 L 662.5901981130274 412.5413708278333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 432.1854999245 L 659.6582385463607 432.1854999245 M 659.6582385463607 422.07023941949996 L 758.8114786330013 422.07023941949996 L 766.7277694630013 429.98653024949994 L 766.7277694630013 442.3007604295 L 659.6582385463607 442.3007604295 L 659.6582385463607 422.07023941949996 M 758.8114786330013 422.07023941949996 L 758.8114786330013 429.98653024949994 L 766.7277694630013 429.98653024949994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="671.9724687263607" y="434.3844695995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Create ticket_digest</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 489.3587114745 L 659.6582385463607 489.3587114745 M 659.6582385463607 479.2434509695 L 930.6669168654232 479.2434509695 L 938.5832076954232 487.15974179949995 L 938.5832076954232 499.4739719795 L 659.6582385463607 499.4739719795 L 659.6582385463607 479.2434509695 M 930.6669168654232 479.2434509695 L 930.6669168654232 487.15974179949995 L 938.5832076954232 487.15974179949995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="671.9724687263607" y="491.5576811495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob's email_address is in access_token returned at step 3. a)</text></g><g><g><rect fill="white" stroke="none" x="737.6580918041733" y="512.6677900295" width="95.96113604652344" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="737.6580918041733" y="521.4636687295" width="122.9252626334375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="738.9774736091733" y="520.5840808595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. a) Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="738.9774736091733" y="529.3799595595" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token, ticket_digest)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 532.8983110395 L 935.7392069157567 532.8983110395" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(942.9811470454233,532.8983110395) translate(-942.9811470454233,-532.8983110395)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 935.6512481287566 529.2333615811666 L 942.9811470454233 532.8983110395 L 935.6512481287566 536.5632604978333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 579.9562620844998 L 659.6582385463607 579.9562620844998 M 659.6582385463607 569.8410015794999 L 873.9101267042904 569.8410015794999 L 881.8264175342904 577.7572924094999 L 881.8264175342904 590.0715225894999 L 659.6582385463607 590.0715225894999 L 659.6582385463607 569.8410015794999 M 873.9101267042904 569.8410015794999 L 873.9101267042904 577.7572924094999 L 881.8264175342904 577.7572924094999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="671.9724687263607" y="582.1552317594998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The email_address is determined by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="691.9169724194077" y="603.2653406394999" width="95.96113604652344" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="691.9169724194077" y="612.0612193394999" width="214.40750140296876" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2363542244077" y="611.1816314694998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. b) Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.2363542244077" y="619.9775101694999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token, Bob's email_address, ticket_digest)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 623.4958616494998 L 935.7392069157567 623.4958616494998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(942.9811470454233,623.4958616494998) translate(-942.9811470454233,-623.4958616494998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 935.6512481287566 619.8309121911665 L 942.9811470454233 623.4958616494998 L 935.6512481287566 627.1608111078332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 659.9987582544998 L 947.3790863954233 659.9987582544998 M 947.3790863954233 649.8834977494998 L 1376.7202232105797 649.8834977494998 L 1384.6365140405796 657.7997885794998 L 1384.6365140405796 670.1140187594998 L 947.3790863954233 670.1140187594998 L 947.3790863954233 649.8834977494998 M 1376.7202232105797 649.8834977494998 L 1376.7202232105797 657.7997885794998 L 1384.6365140405796 657.7997885794998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="959.6933165754233" y="662.1977279294997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider is assigned the 'query-users' admin role, thus can query any user to get their claims</text></g><g><g><rect fill="white" stroke="none" x="1063.0627470262828" y="683.3078368094998" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1063.0627470262828" y="692.1037155094998" width="205.8901063834375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1064.3821288312827" y="691.2241276394998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1064.3821288312827" y="700.0200063394998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, role=query-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 703.5383578194998 L 1381.7925132609128 703.5383578194998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1389.0344533905795,703.5383578194998) translate(-1389.0344533905795,-703.5383578194998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1381.7045544739128 699.8734083611664 L 1389.0344533905795 703.5383578194998 L 1381.7045544739128 707.2033072778331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1115.6883726366343" y="716.7321758694998" width="100.63885516273437" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1117.0077544416342" y="724.6484666994997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1389.0344533905795 728.1668181794997 L 950.22308717509 728.1668181794997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(942.9811470454233,728.1668181794997) translate(-942.9811470454233,-728.1668181794997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 950.31104596209 724.5018687211664 L 942.9811470454233 728.1668181794997 L 950.31104596209 731.8317676378331 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 775.2247692244997 L 947.3790863954233 775.2247692244997 M 947.3790863954233 765.1095087194998 L 1305.993965886361 765.1095087194998 L 1313.910256716361 773.0257995494998 L 1313.910256716361 785.3400297294997 L 947.3790863954233 785.3400297294997 L 947.3790863954233 765.1095087194998 M 1305.993965886361 765.1095087194998 L 1305.993965886361 773.0257995494998 L 1313.910256716361 773.0257995494998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="959.6933165754233" y="777.4237388994997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Use Bob's email_address extracted from access_token from a request at step 5. a)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 832.3979807744996 L 947.3790863954233 832.3979807744996 M 947.3790863954233 822.2827202694997 L 1247.9344566090172 822.2827202694997 L 1255.8507474390171 830.1990110994997 L 1255.8507474390171 842.5132412794997 L 947.3790863954233 842.5132412794997 L 947.3790863954233 822.2827202694997 M 1247.9344566090172 822.2827202694997 L 1247.9344566090172 830.1990110994997 L 1255.8507474390171 830.1990110994997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="959.6933165754233" y="834.5969504494996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Use Bob's email_address extracted from a request body at step 5. b)</text></g><g><g><rect fill="white" stroke="none" x="1087.3213758714976" y="868.9008773794997" width="116.40284747230469" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1087.3213758714976" y="877.6967560794997" width="157.37284869300782" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1088.6407576764975" y="876.8171682094996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query Bob's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1088.6407576764975" y="885.6130469094996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token, Bob's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 889.1313983894996 L 1381.7925132609128 889.1313983894996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1389.0344533905795,889.1313983894996) translate(-1389.0344533905795,-889.1313983894996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1381.7045544739128 885.4664489311663 L 1389.0344533905795 889.1313983894996 L 1381.7045544739128 892.796347847833 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1106.508265519935" y="902.3252164394996" width="118.99906939613281" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1107.827647324935" y="910.2415072694996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Bob's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1389.0344533905795 913.7598587494996 L 950.22308717509 913.7598587494996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(942.9811470454233,913.7598587494996) translate(-942.9811470454233,-913.7598587494996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 950.31104596209 910.0949092911662 L 942.9811470454233 913.7598587494996 L 950.31104596209 917.4248082078329 Z"/></g></g><g><g><rect fill="white" stroke="none" x="728.4779846874741" y="926.9536767994996" width="103.22596758949219" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="728.4779846874741" y="935.7495554994996" width="141.28547686683595" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="729.7973664924741" y="934.8699676294996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="729.7973664924741" y="943.6658463294996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Bob's user_claims, ticket_digest)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 942.9811470454233 947.1841978094996 L 662.5022393260274 947.1841978094996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,947.1841978094996) translate(-655.2602991963607,-947.1841978094996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 662.5901981130274 943.5192483511662 L 655.2602991963607 947.1841978094996 L 662.5901981130274 950.8491472678329 Z"/></g></g><g><g><rect fill="white" stroke="none" x="344.50562864861007" y="960.3780158594996" width="97.36843890296875" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="344.50562864861007" y="969.1738945594996" width="207.43872088539064" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="345.82501045361005" y="968.2943066894995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="345.82501045361005" y="977.0901853894995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token + metadata)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 980.6085368694995 L 248.43161911591667 980.6085368694995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(241.18967898625002,980.6085368694995) translate(-241.18967898625002,-980.6085368694995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 248.5195779029167 976.9435874111662 L 241.18967898625002 980.6085368694995 L 248.5195779029167 984.2734863278329 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 65.54418049570313 1017.5512274094996 L 408.9188866467969 1017.5512274094996 L 416.8351774767969 1025.4675182394997 L 416.8351774767969 1055.3735058194995 L 65.54418049570313 1055.3735058194995 L 65.54418049570313 1017.5512274094996 M 408.9188866467969 1017.5512274094996 L 408.9188866467969 1025.4675182394997 L 416.8351774767969 1025.4675182394997" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="77.85841067570314" y="1029.8654575894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="77.85841067570314" y="1038.6613362894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="77.85841067570314" y="1047.4572149894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 48.50942860361329 1068.5673238694994 L 425.95363853888676 1068.5673238694994 L 433.86992936888674 1076.4836146994994 L 433.86992936888674 1106.3896022794995 L 48.50942860361329 1106.3896022794995 L 48.50942860361329 1068.5673238694994 M 425.95363853888676 1068.5673238694994 L 425.95363853888676 1076.4836146994994 L 433.86992936888674 1076.4836146994994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="1080.8815540494995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server uses domain part of Bob's email_address extracted from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="1089.6774327494995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to load Claims Provider configuration from URL:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.8236587836133" y="1098.4733114494995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="85.41934664982423" y="1098.4733114494995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="90.60266574162111" y="1098.4733114494995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">' + domain_part_of_email_address + '/.well-known/claims-provider-configuration'</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 126.74191151376955 1119.5834203294994 L 347.7211556287305 1119.5834203294994 L 355.6374464587305 1127.4997111594994 L 355.6374464587305 1192.5892135394995 L 126.74191151376955 1192.5892135394995 L 126.74191151376955 1119.5834203294994 M 347.7211556287305 1119.5834203294994 L 347.7211556287305 1127.4997111594994 L 355.6374464587305 1127.4997111594994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1131.8976505094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AuthZ Server evaluates:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1140.6935292094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. domain part of email_address vs. claims issuer</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1149.4894079094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. ticket</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1158.2852866094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. ticket_digest vs. ticket</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1167.0811653094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1175.8770440094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="139.05614169376955" y="1184.6729227094995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. other_claims (recipient_info, file_info)</text></g><g><g><rect fill="white" stroke="none" x="414.50308043083663" y="1218.9768496394993" width="67.4438173209375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="415.8224622358366" y="1226.8931404694993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 241.18967898625002 1230.4114919494994 L 648.0183590666941 1230.4114919494994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,1230.4114919494994) translate(-655.2602991963607,-1230.4114919494994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 647.930400279694 1226.746542491166 L 655.2602991963607 1230.4114919494994 L 647.930400279694 1234.0764414078326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="457.4722038805534" y="1243.6053099994992" width="187.37963885414064" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="457.4722038805534" y="1252.4011886994992" width="27.507705870742186" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="458.7915856855534" y="1251.5216008294992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Get data from Alice's 'Outgoing' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="458.7915856855534" y="1260.3174795294992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 655.2602991963607 1263.8358310094993 L 454.3056875485534 1263.8358310094993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(447.06374741888675,1263.8358310094993) translate(-447.06374741888675,-1263.8358310094993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 454.3936463355534 1260.170881551166 L 447.06374741888675 1263.8358310094993 L 454.3936463355534 1267.5007804678326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="526.2467323839713" y="1277.0296490594992" width="49.830581847304686" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="527.5661141889714" y="1284.9459398894992" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. 200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 447.06374741888675 1288.4642913694993 L 648.0183590666941 1288.4642913694993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(655.2602991963607,1288.4642913694993) translate(-655.2602991963607,-1288.4642913694993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 647.930400279694 1284.799341911166 L 655.2602991963607 1288.4642913694993 L 647.930400279694 1292.1292408278325 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 269.90153790949995 L 1419.8200288405794 269.90153790949995 L 1419.8200288405794 384.24796100949993 L 624.4747237463607 384.24796100949993 L 624.4747237463607 269.90153790949995 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 269.90153790949995 L 624.4747237463607 280.45659234949994 L 650.7642350526107 280.45659234949994 L 656.0417622726108 275.1790651295 L 656.0417622726108 269.90153790949995 L 624.4747237463607 269.90153790949995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="633.2706024463607" y="276.93824086949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.8376409726108" y="276.93824086949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[RqP Client uses Authorization Code Grant - Bob is involved]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 327.0747494594999 L 1419.8200288405794 327.0747494594999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="2.198969675"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.8376409726108" y="334.1114524194999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[RqP Client uses Client Credential Grant - Bob is not involved]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 455.4945784795 L 973.7667224954233 455.4945784795 L 973.7667224954233 636.6896796994998 L 624.4747237463607 636.6896796994998 L 624.4747237463607 455.4945784795 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 455.4945784795 L 624.4747237463607 466.04963291949997 L 650.7642350526107 466.04963291949997 L 656.0417622726108 460.7721056995 L 656.0417622726108 455.4945784795 L 624.4747237463607 455.4945784795" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="633.2706024463607" y="462.5312814395" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.8376409726108" y="462.5312814395" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Get Claims  - Bob was involved at step  3. a)]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 624.4747237463607 546.0921290894998 L 973.7667224954233 546.0921290894998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="2.198969675"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.8376409726108" y="553.1288320494999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Get Claims - Bob was not involved at step  3. b)]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 912.1955715954233 741.3606362294997 L 1318.3081960663608 741.3606362294997 L 1318.3081960663608 855.7070593294997 L 912.1955715954233 855.7070593294997 L 912.1955715954233 741.3606362294997 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 912.1955715954233 741.3606362294997 L 912.1955715954233 751.9156906694998 L 938.4850829016733 751.9156906694998 L 943.7626101216733 746.6381634494998 L 943.7626101216733 741.3606362294997 L 912.1955715954233 741.3606362294997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="920.9914502954233" y="748.3973391894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="952.5584888216733" y="748.3973391894998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Prepare email_address - Bob was involved at step  3. a)]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 912.1955715954233 798.5338477794996 L 1318.3081960663608 798.5338477794996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="2.198969675"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="952.5584888216733" y="805.5705507394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Prepare email_address - Bob was not involved at step  3. b)]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.111489253613286 993.8023549194995 L 438.26786871888675 993.8023549194995 L 438.26786871888675 1205.7830315894994 L 44.111489253613286 1205.7830315894994 L 44.111489253613286 993.8023549194995 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 44.111489253613286 993.8023549194995 L 44.111489253613286 1004.3574093594996 L 140.38334614091798 1004.3574093594996 L 145.66087336091798 999.0798821394995 L 145.66087336091798 993.8023549194995 L 44.111489253613286 993.8023549194995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="52.90736795361329" y="1000.8390578794996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g></g></g></svg>