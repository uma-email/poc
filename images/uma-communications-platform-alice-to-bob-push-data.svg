<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1590" height="1168"><desc>Title%20UMA%20communications%20platform%20-%20Alice%20to%20Bob%20(push%20data)%0A%0Aactor%20%22Alice%20(RqP)%5Cnalice%40gmail.com%20or%20alice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22IAM%20Server%5Cnfoo.com%22%20as%20authServer%20%23lightpink%0Aparticipant%20%22IMAP%20Server%5Cngmail.com%22%20as%20imapServer%20%23de5246%0Aparticipant%20%22SMTP%20Server%5Cngmail.com%22%20as%20smtpServer%20%23de5246%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnfoo.com%22%20as%20claimsProvider%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnfoo.com%22%20as%20rqpClient%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnbar.com%22%20as%20rsServer%20%23lightsteelblue%0Aparticipant%20%22UMA%20Server%5Cnbar.com%22%20as%20asServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RO)%5Cnbob%40outlook.com%20or%20bob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Aopt%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0Anote%20over%20Alice%3AIf%20Alice%20uses%20an%20email%20provider%20(gmail)%20that%20does%20not%20support%5Cnthe%20WebFinger%20protocol%2C%20she%20must%20set%20up%20her%20email%20address%20to%20automatically%5Cnforward%20emails%20sent%20from%20challenge%40foo.com%20to%20response%40foo.com%0Aend%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Ffoo.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Alice's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%5Cn%E2%80%A2%20can%20send%20email%20messages%20from%20address%20challenge%40foo.com%20and%20retrieve%20from%20response%40foo.com%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20foo.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20bar.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20foo.com%20IAM%20Server%0Anote%20over%20rsServer%3Abar.com%20admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%5Cn'Incoming'%20at%20the%20bar.com%20UMA%20Server%20with%20the%20associated%20scope%20'create'%0AAlice-%3ErqpClient%3AInitiate%20request%0ArqpClient-%3ErsServer%3A1.%20Request%20Bob's%20'Incoming'%20resource%5Cn(scope%3Dcreate)%0ArqpClient%3C-rsServer%3A2.%20401%20with%20permission%20ticket%0AauthServer%3C-rqpClient%3A3.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0AauthServer-%3ErqpClient%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Alice's%20email_address%2C%20ticket_challenge)%0AauthServer%3C-claimsProvider%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Drealm-management%2C%20role%3Dquery-users%2C%20view-users)%0AauthServer-%3EclaimsProvider%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Alice's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Alice's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Alice's%20user_claims%0A%0Aopt%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0AsmtpServer%3C-claimsProvider%3A10.%20Send%20plain_message%20from%20challenge%40foo.com%20to%20alice%40gmail.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0AimapServer-%3EclaimsProvider%3A11.%20Retrieve%20dkim_signed_message%20sent%20from%20alice%40gmail.com%20to%20response%40foo.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0Aend%0AclaimsProvider-%3ErqpClient%3A12.%20Return%20claims_token%5Cn(Alice's%20user_claims%2C%20dkim_signed_message%20-%20optional)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Aalt%20Domain%20part%20of%20email_address%20or%20WebFinger%20is%20used%20to%20locate%20Claims%20Provider%20configuration%20url%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aelse%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0Anote%20over%20asServer%3A1.%20extract%20dkim_signed%20_message%20from%20claims_token%5Cn2.%20verify%20DKIM%20signature%20of%20dkim_signed%20_message%5Cn3.%20extract%20'From%3A'%20part%20of%20dkim_signed_message%20e.g.%20Alice%20Henderson%20%3Calice%40gmail.com%3E%5Cn4.%20extract%20claims_provider_configuration_url%20and%20ticket_challenge%20from%20dkim_signed_message%5Cn5.%20verify%20claims_token%20signature%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20extract%20user_claims%20from%20claims_token%5Cn8.%20evaluate%20user_claims%5Cn9.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArqpClient-%3ErsServer%3A15.%20Post%20data%20into%20Bob's%20'Incoming'%20resource%5Cn(RPT)%0ArqpClient%3C-rsServer%3A16.%20201%20Created</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1590" height="1168"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="669.509721543367" y="11.3089869" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA communications platform - Alice to Bob (push data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 133.16443349087888 66.98689907100001 L 133.16443349087888 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 266.32886698175776 66.98689907100001 L 266.32886698175776 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 376.8141836086288 66.98689907100001 L 376.8141836086288 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 514.170502822203 66.98689907100001 L 514.170502822203 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 743.5149771868514 66.98689907100001 L 743.5149771868514 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 66.98689907100001 L 1017.041610975328 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1199.3763985161092 66.98689907100001 L 1199.3763985161092 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1366.9700720732967 66.98689907100001 L 1366.9700720732967 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1534.5637456304842 66.98689907100001 L 1534.5637456304842 1118.7226807710001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray="5.799480461538462,2.5131082"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 137.46184851287887 27.556231413000003 A 4.297415022 4.297415022 0 1 1 137.46184636417155 27.551933998694235 M 133.16443349087888 31.853646435 L 133.16443349087888 41.051622447 M 127.73611977887887 35.170949259000004 L 138.59274720287888 35.170949259000004 M 133.16443349087888 41.051622447 L 127.73611977887887 49.646452491000005 M 133.16443349087888 41.051622447 L 138.59274720287888 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="116.33530141080075" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.90572072232419" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com or alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 241.50482466868743 39.16679129700001 L 291.1529092948281 39.16679129700001 L 291.1529092948281 66.98689907100001 L 241.50482466868743 66.98689907100001 L 241.50482466868743 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.68499185968744" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="254.49029734064447" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 349.77030792153505 39.16679129700001 L 403.85805929572257 39.16679129700001 L 403.85805929572257 66.98689907100001 L 349.77030792153505 66.98689907100001 L 349.77030792153505 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="357.95047511253506" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="361.6491140285507" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 486.0183355091327 39.16679129700001 L 542.3226701352734 39.16679129700001 L 542.3226701352734 66.98689907100001 L 486.0183355091327 66.98689907100001 L 486.0183355091327 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="494.19850270013274" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.0054332421249" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 704.0832612287616 39.16679129700001 L 782.9466931449413 39.16679129700001 L 782.9466931449413 66.98689907100001 L 704.0832612287616 66.98689907100001 L 704.0832612287616 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="712.2634284197616" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="731.6764075457381" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 992.9537213111835 39.16679129700001 L 1041.1295006394726 39.16679129700001 L 1041.1295006394726 66.98689907100001 L 992.9537213111835 66.98689907100001 L 992.9537213111835 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1001.1338885021835" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1005.2030413342147" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1158.4610018329217 39.16679129700001 L 1240.2917951992968 39.16679129700001 L 1240.2917951992968 66.98689907100001 L 1158.4610018329217 66.98689907100001 L 1158.4610018329217 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1166.6411690239217" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1187.5379356865194" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1340.6672242182342 39.16679129700001 L 1393.2729199283592 39.16679129700001 L 1393.2729199283592 66.98689907100001 L 1340.6672242182342 66.98689907100001 L 1340.6672242182342 39.16679129700001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.8473914092342" y="51.908249870999995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1355.1316092437069" y="59.447574470999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1538.8611606524842 27.556231413000003 A 4.297415022 4.297415022 0 1 1 1538.8611585037768 27.551933998694235 M 1534.5637456304842 31.853646435 L 1534.5637456304842 41.051622447 M 1529.135431918484 35.170949259000004 L 1539.9920593424843 35.170949259000004 M 1534.5637456304842 41.051622447 L 1529.135431918484 49.646452491000005 M 1534.5637456304842 41.051622447 L 1539.9920593424843 49.646452491000005" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1520.5085927374178" y="57.185777091000006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1482.1101323492342" y="64.725101691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com or bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 137.46184851287887 1141.001384964 A 4.297415022 4.297415022 0 1 1 137.46184636417155 1140.9970875496942 M 133.16443349087888 1145.298799986 L 133.16443349087888 1154.496775998 M 127.73611977887887 1148.61610281 L 138.59274720287888 1148.61610281 M 133.16443349087888 1154.496775998 L 127.73611977887887 1163.091606042 M 133.16443349087888 1154.496775998 L 138.59274720287888 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="116.33530141080075" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.90572072232419" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com or alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 241.50482466868743 1118.7226807710001 L 291.1529092948281 1118.7226807710001 L 291.1529092948281 1146.5427885450001 L 241.50482466868743 1146.5427885450001 L 241.50482466868743 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.68499185968744" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="254.49029734064447" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 349.77030792153505 1118.7226807710001 L 403.85805929572257 1118.7226807710001 L 403.85805929572257 1146.5427885450001 L 349.77030792153505 1146.5427885450001 L 349.77030792153505 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="357.95047511253506" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="361.6491140285507" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 486.0183355091327 1118.7226807710001 L 542.3226701352734 1118.7226807710001 L 542.3226701352734 1146.5427885450001 L 486.0183355091327 1146.5427885450001 L 486.0183355091327 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="494.19850270013274" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.0054332421249" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 704.0832612287616 1118.7226807710001 L 782.9466931449413 1118.7226807710001 L 782.9466931449413 1146.5427885450001 L 704.0832612287616 1146.5427885450001 L 704.0832612287616 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="712.2634284197616" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="731.6764075457381" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 992.9537213111835 1118.7226807710001 L 1041.1295006394726 1118.7226807710001 L 1041.1295006394726 1146.5427885450001 L 992.9537213111835 1146.5427885450001 L 992.9537213111835 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1001.1338885021835" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1005.2030413342147" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1158.4610018329217 1118.7226807710001 L 1240.2917951992968 1118.7226807710001 L 1240.2917951992968 1146.5427885450001 L 1158.4610018329217 1146.5427885450001 L 1158.4610018329217 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1166.6411690239217" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1187.5379356865194" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1340.6672242182342 1118.7226807710001 L 1393.2729199283592 1118.7226807710001 L 1393.2729199283592 1146.5427885450001 L 1340.6672242182342 1146.5427885450001 L 1340.6672242182342 1118.7226807710001 Z" stroke-miterlimit="10" stroke-width="1.2062919360000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1348.8473914092342" y="1131.4641393450004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1355.1316092437069" y="1139.0034639450005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1538.8611606524842 1141.001384964 A 4.297415022 4.297415022 0 1 1 1538.8611585037768 1140.9970875496942 M 1534.5637456304842 1145.298799986 L 1534.5637456304842 1154.496775998 M 1529.135431918484 1148.61610281 L 1539.9920593424843 1148.61610281 M 1534.5637456304842 1154.496775998 L 1529.135431918484 1163.091606042 M 1534.5637456304842 1154.496775998 L 1539.9920593424843 1163.091606042" stroke-miterlimit="10" stroke-width="1.2816851820000001" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1520.5085927374178" y="1126.2620053710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1482.1101323492342" y="1133.8013299710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com or bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 11.308986899999987 102.421724691 L 248.23448794175778 102.421724691 L 255.01988008175778 109.207116831 L 255.01988008175778 134.840820471 L 11.308986899999987 134.840820471 L 11.308986899999987 102.421724691 M 248.23448794175778 102.421724691 L 248.23448794175778 109.207116831 L 255.01988008175778 109.207116831" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.86404133999997" y="112.97677913099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Alice uses an email provider (gmail) that does not support</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.86404133999997" y="120.51610373099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the WebFinger protocol, she must set up her email address to automatically</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.86404133999997" y="128.05542833099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">forward emails sent from challenge@foo.com to response@foo.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 521.6288985769296 157.458794271 L 958.6156636567733 157.458794271 L 965.4010557967733 164.244186411 L 965.4010557967733 197.417214651 L 521.6288985769296 197.417214651 L 521.6288985769296 157.458794271 M 958.6156636567733 157.458794271 L 958.6156636567733 164.244186411 L 965.4010557967733 164.244186411" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.1839530169295" y="168.01384871099998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.1839530169295" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="650.6931540667342" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="654.3917929827498" y="175.55317331099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.1839530169295" y="183.09249791099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Alice's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="532.1839530169295" y="190.63182251099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• can send email messages from address challenge@foo.com and retrieve from response@foo.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 838.4764857345468 208.72620155099997 L 1188.8213440761092 208.72620155099997 L 1195.6067362161093 215.51159369099997 L 1195.6067362161093 241.145297331 L 838.4764857345468 241.145297331 L 838.4764857345468 208.72620155099997 M 1188.8213440761092 208.72620155099997 L 1188.8213440761092 215.51159369099997 L 1195.6067362161093 215.51159369099997" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="849.0315401745468" y="219.28125599100002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="849.0315401745468" y="226.820580591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at foo.com IAM Server and pre-registered as a universal AEMS public client at bar.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="849.0315401745468" y="234.359905191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at foo.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1080.3405014857772 252.454284231 L 1311.6269034064412 252.454284231 L 1318.4122955464413 259.23967637100003 L 1318.4122955464413 277.334055411 L 1080.3405014857772 277.334055411 L 1080.3405014857772 252.454284231 M 1311.6269034064412 252.454284231 L 1311.6269034064412 259.23967637100003 L 1318.4122955464413 259.23967637100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1090.8955559257772" y="263.00933867099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com admin has set up the Resource Server and registers it's resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1090.8955559257772" y="270.54866327099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Incoming' at the bar.com UMA Server with the associated scope 'create'</text></g><g><g><rect fill="white" stroke="none" x="552.1410535968145" y="288.643042311" width="45.92393727257812" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="553.2719522868144" y="295.428434451" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 133.16443349087888 298.444164291 L 1010.834233721328 298.444164291" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,298.444164291) translate(-1017.041610975328,-298.444164291)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1010.758840475328 295.302779041 L 1017.041610975328 298.444164291 L 1010.758840475328 301.585549541 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1052.263172278863" y="309.75315119100003" width="111.89166493371094" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="1052.263172278863" y="317.292475791" width="46.84372181847656" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1053.3940709688632" y="316.538543331" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1053.3940709688632" y="324.077867931" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=create)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 327.093597771 L 1193.1690212621093 327.093597771" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1199.3763985161092,327.093597771) translate(-1199.3763985161092,-327.093597771)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1193.0936280161093 323.95221252100004 L 1199.3763985161092 327.093597771 L 1193.0936280161093 330.234983021 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1065.273410926324" y="338.402584671" width="85.87118763878907" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1066.404309616324" y="345.187976811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1199.3763985161092 348.203706651 L 1023.248988229328 348.203706651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,348.203706651) translate(-1017.041610975328,-348.203706651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1023.324381475328 345.062321401 L 1017.041610975328 348.203706651 L 1023.324381475328 351.345091901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="559.7156790946952" y="359.51269355100004" width="62.94157643273437" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="559.7156790946952" y="367.052018151" width="163.9391197676953" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.8465777846952" y="366.29808569100004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="560.8465777846952" y="373.837410291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 376.85314013100003 L 272.53624423575775 376.85314013100003" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(266.32886698175776,376.85314013100003) translate(-266.32886698175776,-376.85314013100003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 272.6116374817578 373.71175488100005 L 266.32886698175776 376.85314013100003 L 272.6116374817578 379.994525381 Z"/></g></g><g><g><rect fill="white" stroke="none" x="561.0937308525077" y="388.162127031" width="161.1830162520703" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="562.2246295425077" y="394.947519171" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 266.32886698175776 397.963249011 L 1010.834233721328 397.963249011" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,397.963249011) translate(-1017.041610975328,-397.963249011)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1010.758840475328 394.82186376100003 L 1017.041610975328 397.963249011 L 1010.758840475328 401.104634261 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 921.7981257491953 409.27223591100005 L 1105.4997040614608 409.27223591100005 L 1112.2850962014609 416.05762805100005 L 1112.2850962014609 434.15200709100003 L 921.7981257491953 434.15200709100003 L 921.7981257491953 409.27223591100005 M 1105.4997040614608 409.27223591100005 L 1105.4997040614608 416.05762805100005 L 1112.2850962014609 416.05762805100005" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="932.3531801891952" y="419.827290351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="932.3531801891952" y="427.366614951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="752.4365112968514" y="445.46099399100007" width="61.085756730585935" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="752.4365112968514" y="453.00031859100005" width="255.68356556847655" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="753.5674099868514" y="452.24638613100007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="753.5674099868514" y="459.78571073100005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Alice's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 462.80144057100006 L 749.7223544408514 462.80144057100006" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(743.5149771868514,462.80144057100006) translate(-743.5149771868514,-462.80144057100006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 749.7977476868514 459.6600553210001 L 743.5149771868514 462.80144057100006 L 749.7977476868514 465.94282582100004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="371.9904557673515" y="474.1104274710001" width="62.94157643273437" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="371.9904557673515" y="481.6497520710001" width="265.86293263390627" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="373.12135445735146" y="480.8958196110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="373.12135445735146" y="488.4351442110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=realm-management, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 743.5149771868514 491.4508740510001 L 272.53624423575775 491.4508740510001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(266.32886698175776,491.4508740510001) translate(-266.32886698175776,-491.4508740510001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 272.6116374817578 488.3094888010001 L 266.32886698175776 491.4508740510001 L 272.6116374817578 494.59225930100007 Z"/></g></g><g><g><rect fill="white" stroke="none" x="418.0365525691093" y="502.7598609510001" width="173.77073903039062" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="419.16745125910927" y="509.5452530910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 266.32886698175776 512.5609829310001 L 737.3075999328514 512.5609829310001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(743.5149771868514,512.5609829310001) translate(-743.5149771868514,-512.5609829310001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 737.2322066868514 509.41959768100014 L 743.5149771868514 512.5609829310001 L 737.2322066868514 515.7023681810001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="396.5028687922538" y="523.869969831" width="102.18022389367188" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="396.5028687922538" y="531.409294431" width="216.83810658410155" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="397.6337674822538" y="530.655361971" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Alice's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="397.6337674822538" y="538.194686571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Alice's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 743.5149771868514 541.2104164110001 L 272.53624423575775 541.2104164110001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(266.32886698175776,541.2104164110001) translate(-266.32886698175776,-541.2104164110001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 272.6116374817578 538.0690311610001 L 266.32886698175776 541.2104164110001 L 272.6116374817578 544.3518016610001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="460.98366560621866" y="552.5194033110001" width="87.87651295617188" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="462.11456429621865" y="559.3047954510001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Alice's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 266.32886698175776 562.3205252910001 L 737.3075999328514 562.3205252910001" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(743.5149771868514,562.3205252910001) translate(-743.5149771868514,-562.3205252910001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 737.2322066868514 559.1791400410001 L 743.5149771868514 562.3205252910001 L 737.2322066868514 565.4619105410001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="523.0920369322031" y="593.985688611" width="211.50140614464843" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="523.0920369322031" y="601.525013211" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="524.2229356222031" y="600.771080751" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Send plain_message from challenge@foo.com to alice@gmail.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="524.2229356222031" y="608.310405351" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 743.5149771868514 611.326135191 L 520.377880076203 611.326135191" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(514.170502822203,611.326135191) translate(-514.170502822203,-611.326135191)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 520.453273322203 608.1847499410001 L 514.170502822203 611.326135191 L 520.453273322203 614.467520441 Z"/></g></g><g><g><rect fill="white" stroke="none" x="431.7297952941659" y="622.635122091" width="256.86957020714846" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="431.7297952941659" y="630.174446691" width="157.65338368371093" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.8606939841659" y="629.420514231" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Retrieve dkim_signed_message sent from alice@gmail.com to response@foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.8606939841659" y="636.959838831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 376.8141836086288 639.975568671 L 737.3075999328514 639.975568671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(743.5149771868514,639.975568671) translate(-743.5149771868514,-639.975568671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 737.2322066868514 636.834183421 L 743.5149771868514 639.975568671 L 737.2322066868514 643.116953921 Z"/></g></g><g><g><rect fill="white" stroke="none" x="774.0806992240975" y="662.593542471" width="74.03749318078125" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="774.0806992240975" y="670.132867071" width="164.091875505" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="774.0806992240975" y="677.672191671" width="212.39518971398437" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="775.2115979140975" y="669.378934611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="775.2115979140975" y="676.918259211" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Alice's user_claims, dkim_signed_message - optional)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="775.2115979140975" y="684.457583811" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 743.5149771868514 687.473313651 L 1010.834233721328 687.473313651" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,687.473313651) translate(-1017.041610975328,-687.473313651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1010.758840475328 684.331928401 L 1017.041610975328 687.473313651 L 1010.758840475328 690.614698901 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1135.4749870848007" y="698.7823005509999" width="70.35185475304688" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="1135.4749870848007" y="706.3216251509999" width="113.06170887902344" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1136.6058857748008" y="705.5676926909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1136.6058857748008" y="713.1070172909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 716.122747131 L 1360.7626948192967 716.122747131" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1366.9700720732967,716.122747131) translate(-1366.9700720732967,-716.122747131)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1360.6873015732967 712.981361881 L 1366.9700720732967 716.122747131 L 1360.6873015732967 719.264132381 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1239.8672652529256 727.431734031 L 1487.2874867536675 727.431734031 L 1494.0728788936676 734.217126171 L 1494.0728788936676 759.850829811 L 1239.8672652529256 759.850829811 L 1239.8672652529256 727.431734031 M 1487.2874867536675 727.431734031 L 1487.2874867536675 734.217126171 L 1494.0728788936676 734.217126171" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.4223196929256" y="737.9867884710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.4223196929256" y="745.526113071" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.4223196929256" y="753.065437671" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1228.8477645205037 811.872169551 L 1498.3069874860894 811.872169551 L 1505.0923796260895 818.657561691 L 1505.0923796260895 889.527212931 L 1228.8477645205037 889.527212931 L 1228.8477645205037 811.872169551 M 1498.3069874860894 811.872169551 L 1498.3069874860894 818.657561691 L 1505.0923796260895 818.657561691" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="822.427223991" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="829.966548591" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="837.505873191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="845.045197791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="852.584522391" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="860.1238469909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="867.6631715909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="875.2024961909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.4028189605037" y="882.7418207909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1218.2247100161092 921.1923762509999 L 1508.930041990484 921.1923762509999 L 1515.715434130484 927.9777683909999 L 1515.715434130484 998.847419631 L 1218.2247100161092 998.847419631 L 1218.2247100161092 921.1923762509999 M 1508.930041990484 921.1923762509999 L 1508.930041990484 927.9777683909999 L 1515.715434130484 927.9777683909999" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="931.747430691" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract dkim_signed _message from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="939.286755291" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. verify DKIM signature of dkim_signed _message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="946.826079891" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. extract 'From:' part of dkim_signed_message e.g. Alice Henderson &lt;alice@gmail.com&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="954.3654044909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. extract claims_provider_configuration_url and ticket_challenge from dkim_signed_message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="961.9047290909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. verify claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="969.4440536909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="976.9833782909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="984.5227028909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.7797644561092" y="992.0620274909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="1167.7535744261093" y="1032.774380331" width="48.50453419640625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1168.8844731161093" y="1039.559772471" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1366.9700720732967 1042.575502311 L 1023.248988229328 1042.575502311" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,1042.575502311) translate(-1017.041610975328,-1042.575502311)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1023.324381475328 1039.434117061 L 1017.041610975328 1042.575502311 L 1023.324381475328 1045.716887561 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1042.455928931695" y="1053.884489211" width="131.50615162804687" height="9.801121980000001"/></g><g><rect fill="white" stroke="none" x="1042.455928931695" y="1061.4238138110002" width="20.00746388390625" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.5868276216952" y="1060.6698813510002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Post data into Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1043.5868276216952" y="1068.2092059510003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1017.041610975328 1071.224935791 L 1193.1690212621093 1071.224935791" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1199.3763985161092,1071.224935791) translate(-1199.3763985161092,-1071.224935791)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1193.0936280161093 1068.083550541 L 1199.3763985161092 1071.224935791 L 1193.0936280161093 1074.366321041 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1083.2092095713435" y="1082.533922691" width="49.99959034875" height="9.801121980000001"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1084.3401082613436" y="1089.3193148310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 201 Created</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1199.3763985161092 1092.335044671 L 1023.248988229328 1092.335044671" stroke-miterlimit="10" stroke-width="0.62827705" stroke-dasharray=""/><g transform="translate(1017.041610975328,1092.335044671) translate(-1017.041610975328,-1092.335044671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1023.324381475328 1089.1936594210001 L 1017.041610975328 1092.335044671 L 1023.324381475328 1095.476429921 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 7.539324599999986 82.065548271 L 258.78954238175777 82.065548271 L 258.78954238175777 146.149807371 L 7.539324599999986 146.149807371 L 7.539324599999986 82.065548271 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.539324599999986 82.065548271 L 7.539324599999986 91.112737791 L 30.90155839472655 91.112737791 L 35.42515315472655 86.58914303099999 L 35.42515315472655 82.065548271 L 7.539324599999986 82.065548271" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="15.078649199999987" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="42.96447775472655" y="88.097007951" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 350.4265475086288 573.6295121910001 L 769.9026132868514 573.6295121910001 L 769.9026132868514 651.284555571 L 350.4265475086288 651.284555571 L 350.4265475086288 573.6295121910001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 350.4265475086288 573.6295121910001 L 350.4265475086288 582.6767017110001 L 373.78878130335534 582.6767017110001 L 378.3123760633553 578.1531069510002 L 378.3123760633553 573.6295121910001 L 350.4265475086288 573.6295121910001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="357.9658721086288" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="385.8517006633553" y="579.6609718710001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1206.9157231161093 771.1598167110001 L 1527.024421030484 771.1598167110001 L 1527.024421030484 1021.465393431 L 1206.9157231161093 1021.465393431 L 1206.9157231161093 771.1598167110001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1206.9157231161093 771.1598167110001 L 1206.9157231161093 780.207006231 L 1278.241610475289 780.207006231 L 1282.765205235289 775.6834114710001 L 1282.765205235289 771.1598167110001 L 1206.9157231161093 771.1598167110001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1214.4550477161094" y="777.1912763910001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1214.4550477161092 791.5159931310001 L 1519.4850964304842 791.5159931310001 L 1519.4850964304842 1010.156406531 L 1214.4550477161092 1010.156406531 L 1214.4550477161092 791.5159931310001 Z" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1214.4550477161092 791.5159931310001 L 1214.4550477161092 800.563182651 L 1235.7515924239217 800.563182651 L 1240.2751871839216 796.0395878910001 L 1240.2751871839216 791.5159931310001 L 1214.4550477161092 791.5159931310001" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1221.9943723161093" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1247.8145117839217" y="797.5474528110001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Domain part of email_address or WebFinger is used to locate Claims Provider configuration url]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1214.4550477161092 900.836199831 L 1519.4850964304842 900.836199831" stroke-miterlimit="10" stroke-width="1.0770463714285714" stroke-dasharray="1.8848311500000001"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1247.8145117839217" y="906.867659511" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g/></g></g></svg>