<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2151" height="1371"><desc>Title%20UMA%20communications%20platform%20-%20Alice%20to%20Bob%20(push%20data)%0A%0Aactor%20%22Alice%20(RqP)%5Cnalice%40gmail.com%2C%20alice%40foo.com%22%20as%20Alice%20%23lightpink%0Aparticipant%20%22IAM%20Server%5Cnfoo.com%22%20as%20authServer%20%23lightpink%0Aparticipant%20%22IMAP%20Server%5Cngmail.com%22%20as%20imapServer%20%23de5246%0Aparticipant%20%22SMTP%20Server%5Cngmail.com%22%20as%20smtpServer%20%23de5246%0Aparticipant%20%22Claims%20Provider%20(CP)%5Cnfoo.com%22%20as%20claimsProvider%20%23lightpink%0Aparticipant%20%22RqP%20Client%5Cnfoo.com%22%20as%20rqpClient%20%23lightpink%0Aparticipant%20%22Resource%20Server%20(RS)%5Cnbar.com%22%20as%20rsServer%20%23lightsteelblue%0Aparticipant%20%22UMA%20Server%5Cnbar.com%22%20as%20asServer%20%23lightsteelblue%0Aactor%20%22Bob%20(RO)%5Cnbob%40outlook.com%2C%20bob%40bar.com%22%20as%20Bob%20%23lightsteelblue%0A%0Abottomparticipants%0A%0Aopt%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0Anote%20over%20Alice%3AIf%20Alice%20uses%20an%20email%20provider%20(gmail)%20that%20does%20not%20support%5Cnthe%20WebFinger%20protocol%2C%20she%20must%20set%20up%20her%20email%20address%20to%20automatically%5Cnforward%20emails%20sent%20from%20challenge%40foo.com%20to%20response%40foo.com%0Aend%0Anote%20over%20claimsProvider%3AClaims%20Provider%3A%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20https%3A%2F%2Ffoo.com%2F.well-known%2Fclaims-provider-configuration%5Cn%E2%80%A2%20is%20registered%20at%20Alice's%20IAM%20Server%20and%20is%20assigned%20'query-users'%2C%20'view-users'%20admin%20roles%2C%20thus%20can%20query%20and%20view%20any%20user%20to%20get%20their%20claims%5Cn%E2%80%A2%20can%20send%20email%20messages%20from%20address%20challenge%40foo.com%20and%20retrieve%20from%20response%40foo.com%0Anote%20over%20rqpClient%3ARqP%20Client%3A%5Cn%E2%80%A2%20is%20registered%20at%20foo.com%20IAM%20Server%20and%20pre-registered%20as%20a%20universal%20AEMS%20public%20client%20at%20bar.com%20UMA%20Server%5Cn%E2%80%A2%20is%20an%20agent%20that%20can%20act%20on%20behalf%20of%20any%20user%20registered%20at%20foo.com%20IAM%20Server%0Anote%20over%20rsServer%3Abar.com%20Admin%20has%20set%20up%20the%20Resource%20Server%20and%20registers%20it's%20resource%20set%5Cn'Incoming'%20and%20'Outgoing'%20with%20the%20bar.com%20UMA%20Server%20with%20the%20associated%20scopes%5Cn'Outgoing'%3A%20query%2C%20view%3B%20'Incoming'%3A%20create%0AAlice-%3ErqpClient%3AInitiate%20request%0ArqpClient-%3ErsServer%3A1.%20Request%20Bob's%20'Incoming'%20resource%5Cn(scope%3Dcreate)%0ArqpClient%3C-rsServer%3A2.%20401%20with%20permission%20ticket%0AauthServer%3C-rqpClient%3A3.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20scope%3Dclaims-provider)%0AauthServer-%3ErqpClient%3A4.%20Return%20access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%0Anote%20over%20rqpClient%3A%E2%80%A2%20ticket_challenge%20%3D%20Base64URL-Encode(SHA256(ticket))%5Cn%E2%80%A2%20the%20email_address%20is%20specified%20by%20RqP%20Client%0AclaimsProvider%3C-rqpClient%3A5.%20Get%20claims_token%5Cn(access_token%20%22audience%22%3A%5B%22claims-provider%22%5D%2C%20Alice's%20email_address%2C%20ticket_challenge)%0AauthServer%3C-claimsProvider%3A6.%20Get%20access_token%5Cn(grant_type%3Dclient_credentials%2C%20role%3Dquery-users%2C%20view-users)%0AauthServer-%3EclaimsProvider%3A7.%20Return%20access_token%20%22audience%22%3A%5B%22realm-management%22%5D%0A%0AauthServer%3C-claimsProvider%3A8.%20Query%2FView%20Alice's%20user_claims%5Cn(access_token%20%22audience%22%3A%5B%22realm-management%22%5D%2C%20Alice's%20email_address)%0AauthServer-%3EclaimsProvider%3A9.%20Return%20Alice's%20user_claims%0A%0Aopt%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0AsmtpServer%3C-claimsProvider%3A10.%20Send%20plain_message%20from%20challenge%40foo.com%20to%20alice%40gmail.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0AimapServer-%3EclaimsProvider%3A11.%20Retrieve%20dkim_signed_message%20sent%20from%20alice%40gmail.com%20to%20response%40foo.com%5Cn(claims_provider_configuration_url%2C%20ticket_challenge)%0Aend%0AclaimsProvider-%3ErqpClient%3A12.%20Return%20claims_token%5Cn(Alice's%20user_claims%2C%20dkim_signed_message%20-%20optional)%5Cnif%20the%20payload%20is%20large%2C%20consider%20using%20PCT%20(see%20UMA%20specs.%20for%20details)%0ArqpClient-%3EasServer%3A13.%20Call%20token%20endpoint%5Cn(ticket%2C%20pushed_claims%3Dclaims_token)%0Anote%20over%20asServer%3AIn%20addition%20to%20claims_token%2C%20pushed%20claims%20may%20also%20contain%20metadata%20such%20as%3A%5Cn%E2%80%A2%20recipient_info%20(email%20address%2C%20fullname)%5Cn%E2%80%A2%20file_info%20(filename%2C%20file%20size%2C%20file%20digest%2C%20mime%20type)%0Agroup%20Authorization%20process%0Aalt%20Domain%20part%20of%20email_address%20or%20WebFinger%20is%20used%20to%20locate%20Claims%20Provider%20configuration%20url%0Anote%20over%20asServer%3A1.%20extract%20user_claims%20from%20claims_token%5Cn2.%20select%20email_address%20claim%5Cn3.%20bootstrap%20discovery%20of%20Claims%20Provider%20config%20url%20from%20email%20address%20via%20WebFinger%3B%5Cnif%20this%20doesn't%20work%2C%20build%20well-known%20url%20using%20domain%20part%20of%20email_address%5Cn4.%20verify%20claims_token%20signature%20%5Cn5.%20extract%20ticket_challenge%20claim%20from%20claims_token%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20evaluate%20user_claims%5Cn8.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aelse%20Alice%20has%20to%20demonstrate%20control%20of%20her%20email%20address%0Anote%20over%20asServer%3A1.%20extract%20dkim_signed%20_message%20from%20claims_token%5Cn2.%20verify%20DKIM%20signature%20of%20dkim_signed%20_message%5Cn3.%20extract%20'From%3A'%20part%20of%20dkim_signed_message%20e.g.%20Alice%20Henderson%20%3Calice%40gmail.com%3E%5Cn4.%20extract%20claims_provider_configuration_url%20and%20ticket_challenge%20from%20dkim_signed_message%5Cn5.%20verify%20claims_token%20signature%5Cn6.%20compare%20ticket_challenge%20vs.%20Base64URL-Encode(SHA256(ticket))%5Cn7.%20extract%20user_claims%20from%20claims_token%5Cn8.%20evaluate%20user_claims%5Cn9.%20evaluate%20other%20optional%20claims%20e.g.%20recipient_info%2C%20file_info%0Aend%0Aend%0ArqpClient%3C-asServer%3A14.%20Return%20RPT%0ArqpClient-%3ErsServer%3A15.%20Post%20data%20into%20Bob's%20'Incoming'%20resource%5Cn(RPT)%0ArqpClient%3C-rsServer%3A16.%20201%20Created</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2151" height="1371"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="10.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="899.3509344163585" y="13.19381805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA communications platform - Alice to Bob (push data)</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 181.48561781007814 78.15138224949999 L 181.48561781007814 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 362.9712356201563 78.15138224949999 L 362.9712356201563 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 483.8999515757897 78.15138224949999 L 483.8999515757897 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 674.0328954332767 78.15138224949999 L 674.0328954332767 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 990.7191017517664 78.15138224949999 L 990.7191017517664 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 78.15138224949999 L 1369.3226664686936 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1621.4860078736936 78.15138224949999 L 1621.4860078736936 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1849.4512659804514 78.15138224949999 L 1849.4512659804514 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2077.4165240872094 78.15138224949999 L 2077.4165240872094 1313.9723395994993" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray="6.766060538461538,2.9319595666666665"/></g><g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 186.49926866907813 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 186.49926616225292 32.143922998476604 M 181.48561781007814 37.16258750749999 L 181.48561781007814 47.893559521499995 M 175.15258514607814 41.03277413549999 L 187.81865047407814 41.03277413549999 M 181.48561781007814 47.893559521499995 L 175.15258514607814 57.92086123949999 M 181.48561781007814 47.893559521499995 L 187.81865047407814 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="157.90110700685548" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.39682691652345" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com, alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 330.10282472333205 45.694589846499994 L 395.8396465169805 45.694589846499994 L 395.8396465169805 78.15138224949999 L 330.10282472333205 78.15138224949999 L 330.10282472333205 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.64635311283206" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.3805450073633" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 447.92064742945377 45.694589846499994 L 519.8792557221257 45.694589846499994 L 519.8792557221257 78.15138224949999 L 447.92064742945377 78.15138224949999 L 447.92064742945377 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="457.4641758189538" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="462.64747202256706" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 636.5004220364525 45.694589846499994 L 711.565368830101 45.694589846499994 L 711.565368830101 78.15138224949999 L 636.5004220364525 78.15138224949999 L 636.5004220364525 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="646.0439504259525" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="652.7804158800541" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 937.3793468608015 45.694589846499994 L 1044.0588566427311 45.694589846499994 L 1044.0588566427311 78.15138224949999 L 937.3793468608015 78.15138224949999 L 937.3793468608015 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="946.9228752503016" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="974.1284111389734" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 1337.485887041596 45.694589846499994 L 1401.1594458957914 45.694589846499994 L 1401.1594458957914 78.15138224949999 L 1337.485887041596 78.15138224949999 L 1337.485887041596 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1347.029415431096" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1352.7319758559006" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1566.0670140911272 45.694589846499994 L 1676.90500165626 45.694589846499994 L 1676.90500165626 78.15138224949999 L 1566.0670140911272 78.15138224949999 L 1566.0670140911272 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1575.6105424806271" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1604.8953782960568" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1814.5104445001311 45.694589846499994 L 1884.3920874607718 45.694589846499994 L 1884.3920874607718 78.15138224949999 L 1814.5104445001311 78.15138224949999 L 1814.5104445001311 45.694589846499994 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1824.053972889631" y="60.5596248495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1832.8606364028146" y="69.3555035495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 2082.4301749462093 32.1489366485 A 5.013650858999999 5.013650858999999 0 1 1 2082.430172439384 32.143922998476604 M 2077.4165240872094 37.16258750749999 L 2077.4165240872094 47.893559521499995 M 2071.0834914232096 41.03277413549999 L 2083.749556751209 41.03277413549999 M 2077.4165240872094 47.893559521499995 L 2071.0834914232096 57.92086123949999 M 2077.4165240872094 47.893559521499995 L 2083.749556751209 57.92086123949999" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2057.71949497344" y="66.71673993949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2008.0545093167016" y="75.51261863949999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com, bob@bar.com</text></g><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 186.49926866907813 1339.9641611579993 A 5.013650858999999 5.013650858999999 0 1 1 186.49926616225292 1339.959147507976 M 181.48561781007814 1344.9778120169992 L 181.48561781007814 1355.7087840309991 M 175.15258514607814 1348.8479986449993 L 187.81865047407814 1348.8479986449993 M 181.48561781007814 1355.7087840309991 L 175.15258514607814 1365.7360857489991 M 181.48561781007814 1355.7087840309991 L 187.81865047407814 1365.7360857489991" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="157.90110700685548" y="1322.7682182994993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice (RqP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.39682691652345" y="1331.5640969994993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alice@gmail.com, alice@foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 330.10282472333205 1313.9723395994993 L 395.8396465169805 1313.9723395994993 L 395.8396465169805 1346.4291320024993 L 330.10282472333205 1346.4291320024993 L 330.10282472333205 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.64635311283206" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IAM Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.3805450073633" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 447.92064742945377 1313.9723395994993 L 519.8792557221257 1313.9723395994993 L 519.8792557221257 1346.4291320024993 L 447.92064742945377 1346.4291320024993 L 447.92064742945377 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="457.4641758189538" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IMAP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="462.64747202256706" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="#de5246" stroke="black" paint-order="fill stroke markers" d=" M 636.5004220364525 1313.9723395994993 L 711.565368830101 1313.9723395994993 L 711.565368830101 1346.4291320024993 L 636.5004220364525 1346.4291320024993 L 636.5004220364525 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="646.0439504259525" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMTP Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="652.7804158800541" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">gmail.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 937.3793468608015 1313.9723395994993 L 1044.0588566427311 1313.9723395994993 L 1044.0588566427311 1346.4291320024993 L 937.3793468608015 1346.4291320024993 L 937.3793468608015 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="946.9228752503016" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider (CP)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="974.1284111389734" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightpink" stroke="black" paint-order="fill stroke markers" d=" M 1337.485887041596 1313.9723395994993 L 1401.1594458957914 1313.9723395994993 L 1401.1594458957914 1346.4291320024993 L 1337.485887041596 1346.4291320024993 L 1337.485887041596 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1347.029415431096" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1352.7319758559006" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1566.0670140911272 1313.9723395994993 L 1676.90500165626 1313.9723395994993 L 1676.90500165626 1346.4291320024993 L 1566.0670140911272 1346.4291320024993 L 1566.0670140911272 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1575.6105424806271" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1604.8953782960568" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><path fill="none" stroke="none"/><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 1814.5104445001311 1313.9723395994993 L 1884.3920874607718 1313.9723395994993 L 1884.3920874607718 1346.4291320024993 L 1814.5104445001311 1346.4291320024993 L 1814.5104445001311 1313.9723395994993 Z" stroke-miterlimit="10" stroke-width="1.407340592" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1824.053972889631" y="1328.8373746024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1832.8606364028146" y="1337.6332533024993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com</text></g><g><path fill="lightsteelblue" stroke="black" paint-order="fill stroke markers" d=" M 2082.4301749462093 1339.9641611579993 A 5.013650858999999 5.013650858999999 0 1 1 2082.430172439384 1339.959147507976 M 2077.4165240872094 1344.9778120169992 L 2077.4165240872094 1355.7087840309991 M 2071.0834914232096 1348.8479986449993 L 2083.749556751209 1348.8479986449993 M 2077.4165240872094 1355.7087840309991 L 2071.0834914232096 1365.7360857489991 M 2077.4165240872094 1355.7087840309991 L 2083.749556751209 1365.7360857489991" stroke-miterlimit="10" stroke-width="1.495299379" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2057.71949497344" y="1322.7682182994993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob (RO)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2008.0545093167016" y="1331.5640969994993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bob@outlook.com, bob@bar.com</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 13.193818050000003 119.49201213949999 L 341.8611267401563 119.49201213949999 L 349.7774175701563 127.40830296949999 L 349.7774175701563 157.3142905495 L 13.193818050000003 157.3142905495 L 13.193818050000003 119.49201213949999 M 341.8611267401563 119.49201213949999 L 341.8611267401563 127.40830296949999 L 349.7774175701563 127.40830296949999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.508048230000014" y="131.80624231949997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If Alice uses an email provider (gmail) that does not support</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.508048230000014" y="140.60212101949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the WebFinger protocol, she must set up her email address to automatically</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.508048230000014" y="149.39799971949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">forward emails sent from challenge@foo.com to response@foo.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 682.2432809955945 183.7019266495 L 1291.2786316779384 183.7019266495 L 1299.1949225079384 191.6182174795 L 1299.1949225079384 230.3200837595 L 682.2432809955945 230.3200837595 L 682.2432809955945 183.7019266495 M 1291.2786316779384 183.7019266495 L 1291.2786316779384 191.6182174795 L 1299.1949225079384 191.6182174795" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.5575111755945" y="196.01615682950003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Claims Provider:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.5575111755945" y="204.81203552950004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="860.6375740418055" y="204.81203552950004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="865.8208931336023" y="204.81203552950004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">foo.com/.well-known/claims-provider-configuration</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.5575111755945" y="213.60791422950004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at Alice's IAM Server and is assigned 'query-users', 'view-users' admin roles, thus can query and view any user to get their claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.5575111755945" y="222.40379292950004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• can send email messages from address challenge@foo.com and retrieve from response@foo.com</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1121.5572644136935 243.51390180949997 L 1609.1717776936935 243.51390180949997 L 1617.0880685236934 251.43019263949998 L 1617.0880685236934 281.33618021949997 L 1121.5572644136935 281.33618021949997 L 1121.5572644136935 243.51390180949997 M 1609.1717776936935 243.51390180949997 L 1609.1717776936935 251.43019263949998 L 1617.0880685236934 251.43019263949998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1133.8714945936936" y="255.82813198949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RqP Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1133.8714945936936" y="264.6240106895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at foo.com IAM Server and pre-registered as a universal AEMS public client at bar.com UMA Server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1133.8714945936936" y="273.4198893895" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is an agent that can act on behalf of any user registered at foo.com IAM Server</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1438.3958377522872 294.52999826949997 L 1796.6598871650997 294.52999826949997 L 1804.5761779950997 302.44628909949995 L 1804.5761779950997 332.35227667949994 L 1438.3958377522872 332.35227667949994 L 1438.3958377522872 294.52999826949997 M 1796.6598871650997 294.52999826949997 L 1796.6598871650997 302.44628909949995 L 1804.5761779950997 302.44628909949995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1450.7100679322873" y="306.84422844949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bar.com Admin has set up the Resource Server and registers it's resource set</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1450.7100679322873" y="315.64010714949995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Incoming' and 'Outgoing' with the bar.com UMA Server with the associated scopes</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1450.7100679322873" y="324.43598584949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'Outgoing': query, view; 'Incoming': create</text></g><g><g><rect fill="white" stroke="none" x="743.4904610179796" y="345.54609472949994" width="63.8273622428125" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="744.8098428229796" y="353.4623855594999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 181.48561781007814 356.98073703949996 L 1362.0807263390268 356.98073703949996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,356.98073703949996) translate(-1369.3226664686936,-356.98073703949996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1361.9927675520269 353.3157875811666 L 1369.3226664686936 356.98073703949996 L 1361.9927675520269 360.6456864978333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1417.2667409496898" y="370.17455508949996" width="156.27519244300782" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1417.2667409496898" y="378.97043378949996" width="65.1163026725" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1418.5861227546898" y="378.09084591949994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Request Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1418.5861227546898" y="386.88672461949994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(scope=create)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 390.4050760995 L 1614.2440677440268 390.4050760995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1621.4860078736936,390.4050760995) translate(-1621.4860078736936,-390.4050760995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1614.1561089570268 386.7401266411666 L 1621.4860078736936 390.4050760995 L 1614.1561089570268 394.07002555783333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1435.4994145947094" y="403.5988941495" width="119.80984515296875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1436.8187963997093" y="411.51518497949996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. 401 with permission ticket</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1621.4860078736936 415.0335364595 L 1376.5646065983603 415.0335364595" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,415.0335364595) translate(-1369.3226664686936,-415.0335364595)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1376.6525653853603 411.36858700116665 L 1369.3226664686936 415.0335364595 L 1376.6525653853603 418.69848591783335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="751.5394527843467" y="428.2273545095" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="751.5394527843467" y="437.0232332095" width="229.21499652015626" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="752.8588345893468" y="436.1436453395" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="752.8588345893468" y="444.9395240395" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, scope=claims-provider)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 448.4578755195 L 370.21317574982294 448.4578755195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(362.9712356201563,448.4578755195) translate(-362.9712356201563,-448.4578755195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 370.30113453682293 444.79292606116667 L 362.9712356201563 448.4578755195 L 370.30113453682293 452.1228249778334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="753.4706509044639" y="461.6516935695" width="225.3526002799219" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="754.790032709464" y="469.5679843995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return access_token "audience":["claims-provider"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 362.9712356201563 473.08633587950004 L 1362.0807263390268 473.08633587950004" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,473.08633587950004) translate(-1369.3226664686936,-473.08633587950004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1361.9927675520269 469.4213864211667 L 1369.3226664686936 473.08633587950004 L 1361.9927675520269 476.7512853378334 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1238.3252163790255 486.28015392950005 L 1492.4038257283614 486.28015392950005 L 1500.3201165583614 494.1964447595 L 1500.3201165583614 515.3065536395001 L 1238.3252163790255 515.3065536395001 L 1238.3252163790255 486.28015392950005 M 1492.4038257283614 486.28015392950005 L 1492.4038257283614 494.1964447595 L 1500.3201165583614 494.1964447595" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.6394465590256" y="498.5943841095001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• ticket_challenge = Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1250.6394465590256" y="507.3902628095001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the email_address is specified by RqP Client</text></g><g><g><rect fill="white" stroke="none" x="1001.127558213433" y="528.5003716895001" width="85.07527178871094" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1001.127558213433" y="537.2962503895001" width="357.78665179359376" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1002.446940018433" y="536.4166625195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Get claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1002.446940018433" y="545.2125412195" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["claims-provider"], Alice's email_address, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 548.7308926995 L 997.9610418814331 548.7308926995" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(990.7191017517664,548.7308926995) translate(-990.7191017517664,-548.7308926995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 998.0490006684331 545.0659432411667 L 990.7191017517664 548.7308926995 L 998.0490006684331 552.3958421578334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="549.0197749180708" y="561.9247107495" width="87.67602557289062" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="549.0197749180708" y="570.7205894495" width="255.65078753578126" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="550.3391567230708" y="569.8410015795" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Get access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="550.3391567230708" y="578.6368802795" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(grant_type=client_credentials, role=query-users, view-users)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 990.7191017517664 582.1552317595 L 370.21317574982294 582.1552317595" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(362.9712356201563,582.1552317595) translate(-362.9712356201563,-582.1552317595)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 370.30113453682293 578.4902823011666 L 362.9712356201563 582.1552317595 L 370.30113453682293 585.8201812178334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="555.3485865635786" y="595.3490498095" width="242.99316424476564" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="556.6679683685786" y="603.2653406395" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return access_token "audience":["realm-management"]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 362.9712356201563 606.7836921195 L 983.4771616220997 606.7836921195" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(990.7191017517664,606.7836921195) translate(-990.7191017517664,-606.7836921195)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 983.3892028350997 603.1187426611666 L 990.7191017517664 606.7836921195 L 983.3892028350997 610.4486415778333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="525.1710810704145" y="619.9775101695" width="142.66552752601564" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="525.1710810704145" y="628.7733888695" width="303.34817523109376" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="526.4904628754146" y="627.8938009995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Query/View Alice's user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="526.4904628754146" y="636.6896796995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(access_token "audience":["realm-management"], Alice's email_address)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 990.7191017517664 640.2080311794999 L 370.21317574982294 640.2080311794999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(362.9712356201563,640.2080311794999) translate(-362.9712356201563,-640.2080311794999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 370.30113453682293 636.5430817211666 L 362.9712356201563 640.2080311794999 L 370.30113453682293 643.8729806378333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="615.5351176304731" y="653.4018492294999" width="122.62010211097656" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.8544994354731" y="661.3181400594999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return Alice's user_claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 362.9712356201563 664.8364915394999 L 983.4771616220997 664.8364915394999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(990.7191017517664,664.8364915394999) translate(-990.7191017517664,-664.8364915394999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 983.3892028350997 661.1715420811665 L 990.7191017517664 664.8364915394999 L 983.3892028350997 668.5014409978332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="684.4413518949434" y="701.7791820795" width="295.86929339515626" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="684.4413518949434" y="710.5750607795" width="220.4061433707422" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="685.7607336999434" y="709.6954729094999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Send plain_message from challenge@foo.com to alice@gmail.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="685.7607336999434" y="718.4913516094999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 990.7191017517664 722.0097030894999 L 681.2748355629434 722.0097030894999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(674.0328954332767,722.0097030894999) translate(-674.0328954332767,-722.0097030894999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 681.3627943499434 718.3447536311666 L 674.0328954332767 722.0097030894999 L 681.3627943499434 725.6746525478333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="557.5850392679578" y="735.2035211394999" width="359.44897479164064" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="557.5850392679578" y="743.9993998394999" width="220.4061433707422" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.9044210729578" y="743.1198119694999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Retrieve dkim_signed_message sent from alice@gmail.com to response@foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.9044210729578" y="751.9156906694999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(claims_provider_configuration_url, ticket_challenge)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 483.8999515757897 755.4340421494999 L 983.4771616220997 755.4340421494999" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(990.7191017517664,755.4340421494999) translate(-990.7191017517664,-755.4340421494999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 983.3892028350997 751.7690926911665 L 990.7191017517664 755.4340421494999 L 983.3892028350997 759.0989916078332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1031.4599251567925" y="781.8216782494999" width="103.22596758949219" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1031.4599251567925" y="790.6175569494999" width="229.42907733070314" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1031.4599251567925" y="799.4134356494999" width="297.121917906875" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1032.7793069617924" y="789.7379690794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Return claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1032.7793069617924" y="798.5338477794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(Alice's user_claims, dkim_signed_message - optional)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1032.7793069617924" y="807.3297264794999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if the payload is large, consider using PCT (see UMA specs. for details)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 990.7191017517664 810.8480779594998 L 1362.0807263390268 810.8480779594998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,810.8480779594998) translate(-1369.3226664686936,-810.8480779594998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1361.9927675520269 807.1831285011665 L 1369.3226664686936 810.8480779594998 L 1361.9927675520269 814.5130274178332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1530.4295305255296" y="824.0418960094999" width="98.06091326820312" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1530.4295305255296" y="832.8377747094999" width="157.91487139808595" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1531.7489123305295" y="831.9581868394998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Call token endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1531.7489123305295" y="840.7540655394998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(ticket, pushed_claims=claims_token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 844.2724170194998 L 1842.2093258507846 844.2724170194998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1849.4512659804514,844.2724170194998) translate(-1849.4512659804514,-844.2724170194998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1842.1213670637846 840.6074675611665 L 1849.4512659804514 844.2724170194998 L 1842.1213670637846 847.9373664778332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1673.8057674899044 857.4662350694998 L 2017.1804736409981 857.4662350694998 L 2025.096764470998 865.3825258994998 L 2025.096764470998 895.2885134794998 L 1673.8057674899044 895.2885134794998 L 1673.8057674899044 857.4662350694998 M 2017.1804736409981 857.4662350694998 L 2017.1804736409981 865.3825258994998 L 2025.096764470998 865.3825258994998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1686.1199976699045" y="869.7804652494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">In addition to claims_token, pushed claims may also contain metadata such as:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1686.1199976699045" y="878.5763439494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• recipient_info (email address, fullname)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1686.1199976699045" y="887.3722226494997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• file_info (filename, file size, file digest, mime type)</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1658.3629269137325 955.9800765094998 L 2032.62331421717 955.9800765094998 L 2040.53960504717 963.8963673394998 L 2040.53960504717 1046.5776271194998 L 1658.3629269137325 1046.5776271194998 L 1658.3629269137325 955.9800765094998 M 2032.62331421717 955.9800765094998 L 2032.62331421717 963.8963673394998 L 2040.53960504717 963.8963673394998" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="968.2943066894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="977.0901853894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. select email_address claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="985.8860640894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. bootstrap discovery of Claims Provider config url from email address via WebFinger;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="994.6819427894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if this doesn't work, build well-known url using domain part of email_address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="1003.4778214894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. verify claims_token signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="1012.2737001894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. extract ticket_challenge claim from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="1021.0695788894997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="1029.8654575894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1670.6771570937326" y="1038.6613362894996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate other optional claims e.g. recipient_info, file_info</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1643.4757046236934 1083.5203176594996 L 2047.510536507209 1083.5203176594996 L 2055.426827337209 1091.4366084894996 L 2055.426827337209 1174.1178682694997 L 1643.4757046236934 1174.1178682694997 L 1643.4757046236934 1083.5203176594996 M 2047.510536507209 1083.5203176594996 L 2047.510536507209 1091.4366084894996 L 2055.426827337209 1091.4366084894996" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1095.8345478394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. extract dkim_signed _message from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1104.6304265394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. verify DKIM signature of dkim_signed _message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1113.4263052394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. extract 'From:' part of dkim_signed_message e.g. Alice Henderson &lt;alice@gmail.com&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1122.2221839394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. extract claims_provider_configuration_url and ticket_challenge from dkim_signed_message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1131.0180626394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. verify claims_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1139.8139413394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. compare ticket_challenge vs. Base64URL-Encode(SHA256(ticket))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1148.6098200394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. extract user_claims from claims_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1157.4056987394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. evaluate user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1655.7899348036935" y="1166.2015774394997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. evaluate other optional claims e.g. recipient_info, file_info</text></g><g><g><rect fill="white" stroke="none" x="1575.6650575641038" y="1213.6993224194994" width="67.4438173209375" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1576.9844393691037" y="1221.6156132494993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">14. Return RPT</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1849.4512659804514 1225.1339647294994 L 1376.5646065983603 1225.1339647294994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,1225.1339647294994) translate(-1369.3226664686936,-1225.1339647294994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1376.6525653853603 1221.4690152711662 L 1369.3226664686936 1225.1339647294994 L 1376.6525653853603 1228.7989141878327 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1403.522760541975" y="1238.3277827794993" width="183.7631532584375" height="11.43464231"/></g><g><rect fill="white" stroke="none" x="1403.522760541975" y="1247.1236614794993" width="27.507705870742186" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.842142346975" y="1246.2440736094993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">15. Post data into Bob's 'Incoming' resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1404.842142346975" y="1255.0399523094993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(RPT)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1369.3226664686936 1258.5583037894994 L 1614.2440677440268 1258.5583037894994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1621.4860078736936,1258.5583037894994) translate(-1621.4860078736936,-1258.5583037894994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1614.1561089570268 1254.8933543311662 L 1621.4860078736936 1258.5583037894994 L 1614.1561089570268 1262.2232532478326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1460.6348287182445" y="1271.7521218394993" width="69.53901690589844" height="11.43464231"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1461.9542105232445" y="1279.6684126694993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">16. 201 Created</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1621.4860078736936 1283.1867641494994 L 1376.5646065983603 1283.1867641494994" stroke-miterlimit="10" stroke-width="0.7329898916666666" stroke-dasharray=""/><g transform="translate(1369.3226664686936,1283.1867641494994) translate(-1369.3226664686936,-1283.1867641494994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1376.6525653853603 1279.5218146911661 L 1369.3226664686936 1283.1867641494994 L 1376.6525653853603 1286.8517136078326 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.795878700000003 95.7431396495 L 354.1753569201563 95.7431396495 L 354.1753569201563 170.5081085995 L 8.795878700000003 170.5081085995 L 8.795878700000003 95.7431396495 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878700000003 95.7431396495 L 8.795878700000003 106.29819408949999 L 37.974931632226564 106.29819408949999 L 43.25245885222657 101.02066686949999 L 43.25245885222657 95.7431396495 L 8.795878700000003 95.7431396495" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="17.591757400000002" y="102.77984260949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="52.04833755222657" y="102.77984260949998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 453.1143761257897 678.0303095894999 L 1021.5046772017664 678.0303095894999 L 1021.5046772017664 768.6278601994999 L 453.1143761257897 768.6278601994999 L 453.1143761257897 678.0303095894999 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 453.1143761257897 678.0303095894999 L 453.1143761257897 688.5853640294999 L 482.2934290580163 688.5853640294999 L 487.5709562780163 683.3078368094999 L 487.5709562780163 678.0303095894999 L 453.1143761257897 678.0303095894999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="461.9102548257897" y="685.0670125495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">opt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="496.3668349780163" y="685.0670125495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1630.2818865736936 908.4823315294998 L 2068.620645387209 908.4823315294998 L 2068.620645387209 1200.5055043694995 L 1630.2818865736936 1200.5055043694995 L 1630.2818865736936 908.4823315294998 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1630.2818865736936 908.4823315294998 L 1630.2818865736936 919.0373859694998 L 1726.5537434609982 919.0373859694998 L 1731.8312706809982 913.7598587494998 L 1731.8312706809982 908.4823315294998 L 1630.2818865736936 908.4823315294998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1639.0777652736936" y="915.5190344894999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization process</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1639.0777652736936 932.2312040194997 L 2059.8247666872094 932.2312040194997 L 2059.8247666872094 1187.3116863194996 L 1639.0777652736936 1187.3116863194996 L 1639.0777652736936 932.2312040194997 Z" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1639.0777652736936 932.2312040194997 L 1639.0777652736936 942.7862584594998 L 1665.3672765799436 942.7862584594998 L 1670.6448037999435 937.5087312394998 L 1670.6448037999435 932.2312040194997 L 1639.0777652736936 932.2312040194997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1647.8736439736936" y="939.2679069794998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1679.4406824999435" y="939.2679069794998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Domain part of email_address or WebFinger is used to locate Claims Provider configuration url]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1639.0777652736936 1059.7714451694997 L 2059.8247666872094 1059.7714451694997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="2.198969675"/></g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1679.4406824999435" y="1066.8081481294996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Alice has to demonstrate control of her email address]</text></g><g/></g></g></svg>